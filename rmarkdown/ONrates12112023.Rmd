
---
title: "ONrates12022023"
author: "Hammond"
date: "`r format(Sys.Date(), '%Y-%m-%d')`"
output: 
  pdf_document:
    latex_engine: xelatex
    keep_tex: true
echo: false  # Make sure this line is present and set to false
header-includes:
  - \usepackage{booktabs}
  - \usepackage{float}
---

```{r setup, include=FALSE}
# Load required libraries
library(ggplot2)
library(dplyr)
library(tidyverse)
library(knitr)
library(xtable)
library(tinytex)
library(gridExtra)
library(reshape2)
library(bookdown)
# Set global knitr options
knitr::opts_chunk$set(echo = FALSE)
```

```{r, clear environment, echo=TRUE}
# Clear the environment
#rm(list = ls())
```
#Load the environment from the RDS file
```{r, load environment, echo=FALSE}
my_envmp <- readRDS("C:/Users/Owner/Documents/Research/MonetaryPolicy/MPResults/LaTeX/my_environmentmp.RDS")
```

<!--
https://rstudio.github.io/visual-markdown-editing/technical.html#:~:text=In%20raw%20markdown%2C%20you%20would,to%20escape%20the%20%40%20character).


Structure of article: IMRAD:
Introduction
Data
Methodology
Results and
Discussion

Conclusion
Acknowledgements
References
Supporting Materials

Discussing figures in a scientific paper is an important aspect of effectively communicating your research findings. Figures, such as graphs, charts, and images, help illustrate your points and make your paper more accessible to readers. Here's a step-by-step guide on how to discuss figures in a scientific paper:
1. Introduction:
Start by introducing the figure and its purpose. Briefly explain what the figure represents and why it's important in the context of your study.
2. Figure Description:
Provide a clear and concise description of the figure. Include relevant details about the data, axes, labels, units, and any key components.
3. Interpretation:
Discuss the main findings or trends depicted in the figure. Highlight significant patterns, relationships, or differences. Use specific data points to support your interpretations.
4. Connection to Hypotheses or Research Questions:
Relate the figure's content to the research questions or hypotheses you're addressing in your study. Explain how the figure's information contributes to answering these questions or testing these hypotheses.
5. Comparison with Previous Studies:
If applicable, compare your findings in the figure with results from previous studies. Highlight similarities or differences and discuss potential reasons for these discrepancies.
6. Limitations:
Address any limitations or uncertainties associated with the figure. Discuss potential sources of error, assumptions made, or aspects that could impact the interpretation of the data.
7. Implications:
Discuss the broader implications of the figure's findings. How do the results depicted in the figure contribute to the field's understanding of the topic? How might these findings impact theory, practice, or future research?
8. Integration with Text:
Make sure to integrate your discussion of the figure smoothly within the overall flow of your paper. Refer to the figure by its number and provide context as needed.
9. Clarity and Precision:
Use clear and precise language. Avoid jargon that might confuse readers unfamiliar with your specific field.
10. Visual Aids:
As you discuss the figure, consider referring to specific elements within the figure to guide the reader's understanding. For example, you can mention specific data points, lines, or sections of the graph.
11. Use of Citations:
If you're comparing your figure's results with those from other studies, cite those studies appropriately. This adds credibility to your discussion and allows readers to explore the referenced work.
12. Repetition and Synthesis:
Ensure that the discussion of the figure complements the narrative you've established in the rest of the paper. Avoid repeating information but rather synthesize the figure's insights into the overall story you're telling.
Remember that your goal is to help readers understand the figure's content, its significance, and its implications in the context of your research. By following these steps and maintaining a clear, organized writing style, you can effectively discuss figures in your scientific paper.
-->


```{r, main data spread, echo=FALSE}
#Access the data frame stored in the environment
my_data <- my_envmp$spread_no_na
str(my_data)
``` 


```{r, sdate,echo=FALSE}
sdate<-as.Date(my_data$Date,"%m/%d/%Y"); 
```

```{r, select sample,echo=FALSE}
begs <-which(sdate == as.Date("2016-03-04"))[1] # sample start date 3/04/2016
ends <-which(sdate == as.Date("2022-12-29"))[1] # sample end  date  12/27/2022
print(begs)
print(ends)
#my_data=my_data[begs:ends,]
#spread_no_na=my_data[begs:ends,]
```


```{r, daily quantile dataframes, echo=FALSE,  cache=FALSE,results='hide'}
quantilesE <- spread_no_na[, c("sdate", "EFFR", "Volume_EFFR", "TargetUe_EFFR", "TargetDe_EFFR", "Percentile01_EFFR", "Percentile25_EFFR", "Percentile75_EFFR", "Percentile99_EFFR")]
quantilesO <- spread_no_na[, c("sdate", "OBFR", "Volume_OBFR", "Percentile01_OBFR", "Percentile25_OBFR", "Percentile75_OBFR", "Percentile99_OBFR")]
quantilesT <- spread_no_na[, c("sdate", "TGCR", "Volume_TGCR", "Percentile01_TGCR", "Percentile25_TGCR", "Percentile75_TGCR", "Percentile99_TGCR")]
quantilesB <- spread_no_na[, c("sdate", "BGCR", "Volume_BGCR", "Percentile01_BGCR", "Percentile25_BGCR", "Percentile75_BGCR", "Percentile99_BGCR")]
quantilesS <- spread_no_na[, c("sdate", "SOFR", "Volume_SOFR", "TargetUe_SOFR", "TargetDe_SOFR", "Percentile01_SOFR", "Percentile25_SOFR", "Percentile75_SOFR", "Percentile99_SOFR")]
```

# Introduction
This paper asks how the Federal Reserve Bank temporary adjustment of reserves affects volatility of the FFR and other wholesale overnight money market rates.The FFR is interest rate at
which depository institutions or ”banks” lend funds to each other on an overnight basis. 
Daily overnight rates include the unsecured rates EFFR, OBFR, and secured money market rates, TGCR, BGCR, SOFR. The Federal funds market consists of domestic unsecured borrowings by depository institutions from other depository institutions and certain other entities, primarily government-sponsored enterprises.

- The effective federal funds rate (EFFR) is calculated as a volume-weighted median of overnight federal funds transactions. 
- The overnight bank funding rate (OBFR) is a measure of wholesale, unsecured, overnight bank funding costs. It is calculated using federal funds transactions, certain Eurodollar transactions, and certain domestic deposit transactions
- The Tri-Party General Collateral Rate (TGCR) is a measure of rates on overnight, specific-counterparty tri-party general collateral repurchase agreement (repo) transactions secured by Treasury securities. The Fed uses this market for temporary interventions (David Gibbs, Education Director Chicago Mercantile Exchange (CME). 
- The Broad General Collateral Rate (BGCR) is a measure of rates on overnight Treasury general collateral repurchase agreement (repo) transactions. This market serves agents looking for specific cusip numbers.
The Secured Overnight Financing Rate (SOFR) is a broad measure of the cost of borrowing cash overnight collateralized by Treasury securities. The SOFR includes all trades in the Broad General Collateral Rate plus bilateral Treasury repurchase agreement (repo) transactions cleared through the Delivery-versus-Payment (DVP) service offered by the Fixed Income Clearing Corporation (FICC), which is filtered to remove a portion of transactions considered “specials”. 

The distributions of daily rates rates and transactions transactions, billions of dollars, their medians and standard deviations change dramatically from year to year (Figure \ref{fig:volumesample1}) and within differing FOMC policy regimes (Table \ref{table:FOMCdailyratesstats} ). Here volatility  as measured by the annual standard deviation of the series.

 
 The level of reserves  affects these reference rates. Reserves in the banking system can change either because
1) because funds are transferred between reserves and non-reserve accounts at the Federal
2) changes in the US Treasury account at the Fed
3) The Federal Reserve responds to volatility in the federal funds market by adjusting the reserve
supply to keep the federal funds rate within its target range through repo and reverse repo operations each day

By trading securities with banks and other counterparites, these Federal Reserve purchases or sales of assets from banks change the size of the Federal Reserve balance sheet. A repo transaction,Federal Reserve purchases of securities adds assets to its balance sheet and issues reserves by crediting the Federal Reserve accounts of the selling banks. Fed is lender? When the Federal Reserve lends to counter parties in a reverse repo transaction, the Fed sale of securities lower aggregate reserves as funds are debited from depositor accounts. 

Relationship to other work
Cochrane and Piazzesi
Benzoni
Gara
Duffie Krishnamurthy
Hamilton

<!--
Cochrane and Piazzesi
Benzoni
Gara
Duffie Krishnamurthy

Adam Copeland | Darrell Duffie | Yilin (David) Yang.  Reserves Were Not So Ample After All. July 2021. Federal Reserve Bank of New York Staff Reports, no. 974
JEL classification: G14, D47, D8


Hamilton



Gara Afonso, Kyungmin Kim, Antoine Martin, Ed Nosal, Simon Potter, and Sam Schulhofer-Wohl. Monetary policy implementation with an ample supply of reserves. January, 2020. Federal Reserve Bank Chicago.WP 2020-02
https://doi.org/10.21033/wp-2020-0

Bertolini.L, Bertola, Prati. Day-To-DaY_Monetary Policy and the Volatility of the Federal Funds Interest Rate. December 2000.  IMF WOrking Paper WP/00/206
-->

Bertolini, Bertola, Prati () and Gara () observe the effect of Fed interventions on the volatility in interbank rates. Add
(Schuhlhofer et all propose efficiency in the ample reserves regime adopted (date) address the tradeoff the Fed makes to minimize the frequency of operations, volatility of interest rates, and balance sheet costs 

that daily money market rates hover around Fed targets and quickly revert to them in times of shocks.Bertolini et al note the tendency of short term rates to hover around official targets and quickly revert to them in times of shocks.

There is controversy if overight rates, the FFR in particular, follow a random walk. Hamilton (1996) and others have concluded that the hypothesis that the FFR follows a martingalemis inconsistent with observed daily changes in the federal funds rate. (Bertolini,Bertola, Prati ,) site frictions such as  transactions costs, interbank credit limits, overdraft penalties, obstacles to intra-period arbitrage preclude the FFR from following a martingale process.

Bertolini et al Time series methodology: 
volatility of interest rates - rises in advance of reserve
settlement days - declines in high rate regimes - biweekly periodicity when Fed is perceived as committed to keeping rates close to the target

Although overnight wholesale money market rates change in responese to monetary policy and other shocks, they quick revert to changes in the unsecured federal funds rate (FFR) or administered rates. Duffie and Krishnamuthy prvide evident that dispersion among these secured overnight rights impede passthough of monetary policy to the economy. Mean reverision versus dispersion hypothesis

Summarize others' work:
\emph{Duffie, Krishnamurthy}
Hamilton
Hamilton's model of the conditional mean and the conditional variance of  federal funds rate (He adapt Nelson's (1991) model of daily stock return for variance model ). The volatility consequences of upward and downward moves in interest rates are asymmetric.

Krishnamurthy and VJ link the implicit volatility of rates a symptom, result, of Fed discretionary policy, quantitative easing (QE) and ..asset purchase. 

The  effectiveness of monetary policy to transmit the desired stance of monetary policy to financial markets and the real economy economy depends on efficient transmission of rate changes to other short rates in wholesale and consumer funding market.This paper examines the dispersion and volatility of short term rates. 


To manage the build up in liquidity in reserves, the Fed initiated the policy regime of ample reserves in order to  maintain/manage the Fed Funds rate within its target range. It's administrative rates comprise a floor system where  interest on reserves (IOR) paid on bank reserves with the Fed are the ceiling and the overnight reverse repurchase rate (ONRRP rate) is the  floor. The Fed or FOMC also temporarily intervenes in repurchase (repo) and reverse repo to offset high frequency liquidity shocks to keep federal funds rate close to target.
%stabilize FF around target rate..

The federal funds rate is the Fed's policy rate. The effective federal funds rate (EFFR) tracks transactions in the federal funds market. The overnight  bank funding rate (OBFR), similar to the EFFR, a broad measure of U.S. dollar funding costs for U.S. based banks. The secured overnight funding rate (SOFR) captures transactions in  overnight wholesale funding markets, the tri-party general collateral rate (TGCR) and over the counter broad general collateral rate (BGCR). 

Gara Alonso
Gara: The reserve demand curve describes the price at which banks are willing to borrow and lend their reserve balances as a function of aggregate reserves in the system. The interest rate at which reserves are borrowed and lent is the federal funds rate, which is also the policy rate targeted by the
Federal Open Market Committee (FOMC). The reserve demand function measures banks’ demand for liquidity. Estimating the sensitivity of the federal funds rate to shocks to the level of reserves is of paramount importance for the implementation of monetary policy.

time evolution of aggregate reserves normalized by banks’ total assets to control for the growth of the banking industry in our sample. 

Reserves went through a full expansion-contraction cycle from 2010 to late 2019 and expanded again in early 2020, ranging from
8$\%$ (2010 and 2019) to 19$\%$ (2014 and 2021) of banks’ assets. These movements reflect the Federal
Reserve balance-sheet expansions in response to the 2008 and 2020 crises, as well as the interim
normalization period (2015-2019). 
Panel (b) plots the daily average federal funds rate minus the IORB rate to control for changes in the monetary policy stance, which mechanically shift the curve up and down by moving its lower bound. By comparing panels (a) and (b), we can see a negative
correlation between quantities (reserves) and prices (federal funds rates), which suggests that after
removing month-end data from our daily sample, supply shocks tend to dominate demand shocks.
This is confirmed by panel (c), which plots realized rates against realized reserves and can be seen
as an approximate visualization of the reserve demand curve. It shows a clear nonlinear, downward-sloping relationship between prices and quantities that moves outward over time: the curve moved up and to the right after 2014 and further up after March 2020, at the onset of the Covid pandemic

The curve itself, however, also moves horizontally at a low frequency. In the earlier part of
our sample, the rate sensitivity to reserve shocks fades as reserves exceed 12$\%$  of banks’ assets; in
the latter part, instead, it reemerges around 13$\%$ , suggesting a moderate shift to the right. Below
these thresholds, the curve’s slope gets steeper as reserves decrease, consistent with the theory. A
one-percentage-point drop in normalized reserves increases the federal funds-IORB spread by 1.3
basis points (bp) in 2010 and by 1.1 bp in 2019, while having no effect in 2012-2017 and after March
3, 2020. These estimates are robust to controlling for spillovers from the repo and Treasury markets.
Results are qualitatively similar if we normalize reserves by GDP instead of banks’ assets

%\emph{theory reserve demand}
bank demand:  regulatory requirements and liquidity needs, such as daily payments to other institutions.

Banks borrow and lend reserves in the federal funds market, typically overnight, at the federal funds rate. The reserve demand curve describes the price at which banks are willing to trade reserves as a function of the total amount of reserves in the banking system.

Demand curve slope is banks's reserve demand response to shocks:
Low reserves, negative slope, reduce demand as interest rates or shocks...
As reserves keep decreasing, the slope of the curve, i.e., the sensitivity of rates to reserve shocks, becomes increasingly steeper reflecting the
increasing scarcity value of reserves.

High reserves, 0 slope, no response
the demand curve is flat around the interest rate paid by the Federal Reserve on reserve balances (the IORB rate), which is the banks’ opportunity cost of lending in the federal funds market.
Gara plot: GaraAmpleReserves2022
\begin{comment}
\begin{figure}[ht]
\includegraphics[scale=1.0\textwidth]{GaraReserves.png}
% \includegraphics[scale=0.9, bb=108   268   473   567]{dailyratessample1brush.tex}
\caption{Reserves normalized by commercial deposits, Federal Fund rate EFFR-IOR spread and reserve demand curve}
\label{fig:Gara}
%\centering
\label{fig:gara}
\end{figure}
\end{comment}
Vertical and horizontal reserve demand shift of EFFR-IOR spread and reserve demand curve
2015-2020
2020=2022
a)
aggregate reserves normalized by banks’ total assets to control for the growth of the banking industry
b) the daily average federal funds rate minus the IORB rate to control for changes in the monetary policy stance, which mechanically shift the curve up and down by moving its lower bound
c) the relationship between spreads and normalized reserves.

Changes in the IORB rate, by changing the banks’ opportunity cost of lending in the federal funds market, can be thought of as vertical shifts in the reserve demand curve. To control for these demand shifters, which are unrelated to structural changes in banks’ demand for reserves but simply reflect changes in the monetary policy stance, we express the price p in the demand curve (1) as the spread between federal funds rates and the IORB rate.

''' explains ONRRP: The segmentation of the federal funds market between banks and FHLBs suggests that, under our price normalization, the lower bound of the demand function (1), $\ast(p)$ , should range between the
ONRRP-IORB spread and zero.

\emph{Vertical shift}
Changes in the IORB rate, by changing the banks’ opportunity cost of lending in the federal funds market, can be thought of as vertical shifts in the reserve demand curve.
\emph{Horizontal shift}
These structural changes could be interpreted as the horizontal shifts $\ast(q)$ in the demand curve
(1): for every level of the federal funds rate, they imply an increase in the quantity of aggregate
reserves demanded by the banking system. As a result of these shifts, the level of reserves at which
the curve stops being flat and start displaying a negative slope may have moved over time.
% Full sample, by year


Bertolini, Bertola, Prati () 
-High high frequency patterns of FF rate volatility survive Fed's attempt to keep rates close to target and volatility in check

Both Bertolini, Bertola, Prati () and Gara () observe that the effect of Fed interventions on the volatility in interbank rates 
\begin{itemize}
\item rises in advance of reserve settlement days
\item declines in high rate regimes
\item rises end of quarter, end of year
\item falls before holidays, rises day after
\item other observations:
TS properties.  Many rate changes of half percent or more (annualized), and outliers.  Volatility persistent. maintenace periods, calendar days, end of quarter, end of year, before and after holidays, large rate changes

\end{itemize}

# recover files rsrecovr::recovr(project_path = "all")
COMMENT on Bertolini,Bertola, Prati ()  observation that that volatility in the federal funds rate is lower in high rate regimes or when Fed is perceived as committed to kee

Results section:
Hypotheses 1 Volatility: Noteable is the high frequency of volatility of the Fed's policy rate EFFR as the FOMC manages the FF rate within target range. The volatility is especially high in the Fed October date ample reserves policy regime.  The EFFR and OBFR are respond to changes in FOMC target range for the Federal Funds rate (FFR) and the administered rates - interest on reserves (IOR) and the overnight reverse repurchase rate (ONRRP). But the distributions of secured rates TGCR, BGCR, SOFR share similar characteristics of the distribution of these unsecured rates.The volume of trade in interbank markets even more volatile than rates (Note mean reversion, no change in distribution. Dispersion, changes in distribution coef of variation standard deviation devided by the mean.)

Hypotheses 2 Although overnight wholesale money market rates change in response to monetary policy and other shocks, they quick revert to changes in the unsecured federal funds rate (FFR) or administered rates. Duffie and Krishnamuthy prvide evident that dispersion among these secured overnight rights impede passthough of monetary policy to the economy. Mean reverision versus dispersion hypothesis

Hypothesis 3 The rate data provide evidence of Fed's difference preferences for offsetting volatility in the Federal Funds market whem managing the FFR within its target range, The Fed may change target and administered rates. Temporary changes in reserves (FF market, TGCR) can manage the FFR through repo markets. A  reverse repo increase in reserves through Fed purchase of reserves with securities, lowers the FFR, a a repo with dealers or () decreases in reserves through  increases the FFR.
 
Hypothesis 4: Puzzle: The demand for each instrument, price versus volume reveals,large changes in demand but relatively stable rates A puzzle: price stable, demand fluctuates? Daily rates versus dollar volumes of transactions illustrate demand for these overnight money market instruments. Volumes more volatile than rates

Hypothesis 5 The volatility response of overnight rates to Fed interventions is greater:  the lower reserves, the magnitude of the shock of the monetary policy interventions, the type of  change in policy intervention: the Fed Funds targets, or bounds of the channel for the EFFR rate or the administered rates, the IOR and ONRRP. 
  
Other: 
6. volatiity of transactions
7. spreads, indicators of reserves, arbitrage
8. another research question/hypothesie

               


## Monetary policy during the sample period 2016-2022
##  
* my shocks (FFR changes under episodes)
* Romer and Romer shocks
* other external shocks to these markets

I trace the FOMC rate changes, monetary regimes, and events occurred during the six year period of our sample 2016-2022 (Table \ref{table:FOMCratechanges}). Before the financial crisis of 2008, policy was typically based on adjusting the scarcity value of a limited supply of central bank deposits (reserves), but the substantial increase in liquidity resulting from asset purchases in response to the crisis made other techniques necessary

The QE1, QE2, and QE3 asset purchases challenged changed the bank’s ability to control short-term interest
rates. Asset purchases under QE resulted in central banks changing their overall frameworks for controlling short-term interest rates. FOMC rate changes, monetary regimes, and events occurred during the six year period of our sample 2016-2022 (Table \ref{table:FOMCratechanges}) . 

In 2018 the FOMC adopted target rates, In 2019, the FOMC abandoned active management of scarce reserves and other short term interest rates and adopted a policy of ample reserves.
.

Under this ample reserves regimen The Federal Reserve manages the the policy rate, the Federal Funds rate (FFR) within its target range. On October 1, 2008, Congress gave the Fed the power to pay interest on reserves (IOR) to help control the fed funds rate To implement monetary policy in an ample reserves regime, the FOMC sets administered rates,  the interest rate on reserves (IOR) and the overnight reverse repo rate (ONRPP) to guide the FFR. The IOR rate is the interest rate that banks earn from the Fed on the funds they deposit in their reserve accounts. The IOR is the Fed’s principal tool for interest rate control. It sets a ceiling on the FFR. In 2013, the Federal Reserve introduced the ONRRP facility to set a floor under the EFFR.The overnight reverse repo rate (ONRRP) facility offering rate is the Fed’s supplementary tool for interest rate control.

In the ample reserves regime. the administered rates constitute a “floor” system to manages the FFR within its target range, the upper and lower targets set by the Federal Open Market Committee (FOMC). The ability to set the IOR and the ONRRP are key for the Fed’s implementation of monetary policy. The interest on reserves rate (IOR or IORB) is the Fed’s principal tool for interest rate control.the Fed adjusts administrative rates to manages the FFR between the FOMC target upper and lower bounds.The IOR. 

The administered rates, the IOR and the ON RPP,  along with an ample supply of reserves, created a corridor system for managing the Fed Funds rate. The IOR is the ceiling, the ON RRP the floor. No bank would lend at rates on overnight cash lower than the IOR, the rate they can receive from the Fed. Thus Banks have little or no incentive to lend their reserves to other banks at rates lower than the IOR rate. In this sense, the IOR rate is in effect a reservation rate for banks’ intermediation activities,
No bank should be borrow at a higher rate than the ONRRP. Banks and non-bank financial institutions should be unwilling to invest funds in private markets below the ONRRP. No bank should lend at a lower rate than the ONRPP. Competition among borrowers should drive rates to the discount window (DW) rate. 

Under the Ample Reserves policy, the Federal Reserve manages the FFR within its desired range in a “floor” system through Temporary open market operations (TOMO), short-term repurchase and reverse repurchase agreements. These Short-term repurchase and reverse repurchase agreements are designed to temporarily add or drain reserves available to the banking system and influence day-to-day trading in the Federal Funds market.




On October 1, 2008, Congress gave the Fed the power to pay interest on reserves (IOR) to help control the fed funds rate. The IOR rate is the interest rate that banks earn from the Fed on the funds deposited in their reserve accounts. In 2013, the Federal Reserve introduced the ONRRP facility to set a floor under the EFFR.The overnight reverse repo rate (ONRRP) facility offering rate is the Fed’s supplementary tool for interest rate control. In the recently established repo facility, July 2021, the Standing Repo Facility (SRF), the Desk purchases securities from a counterparty subject to an agreement to repurchase the securities at a later date,  temporarily increases the supply of reserve balances in the banking system and lowers the FFR. 

The administered rates, the IOR and the ONRPP, (and now the repo facility) along with an ample supply of reserves created a corridor system for managing the FFR. These administered rates are key to implementing monetary policy in an ample reserves regime. the Fed adjusts administrative rates to manage the FFR between the FOMC upper and lower target rates set by the Federal Open Market Committee (FOMC). These standing interest rates, the interest on reserves (IOR) is the ceiling of the floor system, the overnight reverse repo purchase (ONRRP) the floor. The ability to set the IOR and the ONRRP are key for the Fed’s implementation of monetary policy. The FOMC sets the administered rates, interest on reserve balances (IOR) on deposits held at the bank, and the overnight reverse repurchase facility (ON RRP). 
.The IOR. The IOR is the ceiling, the ON RRP the floor. Banks have little or no incentive to lend their reserves to other banks at rates lower than the IOR rate. No bank would lend at rates on overnight cash lower than the IOR, the rate they can receive from the Fed. Thus  the IOR is, in effect, a reservation rate for banks’ intermediation activities.

By  similar argument, no bank should be borrow at a higher rate than the ONRRP. Banks and non-bank financial institutions should be unwilling to invest funds in private markets below the ONRRP. No bank should lend at a lower rate than the ONRPP. Competition among borrowers should drive rates to the discount window (DW) rate. 

 
\begin{table}[h!]
\centering
\begin{tabular}{c c c} 
\hline
FOMC rates changes \\
%Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex] 
 \hline\hline
\textbf{2015 to 2018: Returning to Normalcy, mid cycle adjustment 3/4/2016 - 7/31/2019} & \\
Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex]
\hline
20-Dec-18 &	 25 &		2.25 to 2.50\\
Sept. 27, 2018 &		25 &		2.0 to 2.25\\
Jun. 14, 2018&		25 &		1.75 to 2.0\\	
22-Mar-18 &		25&		1.50 to 1.75\\	
Dec. 14, 2017 &		2&	5	1.25 to 1.50\\	
15-Jun-17&		25&		1.00 to 1.25\\	
16-Mar-17&		25 &		0.75 to 1.00\\	
Dec. 15, 2016 &		25 &		0.5 to 0.75\\
Dec. 17, 2015 &		25&		0.25 to 0.50\\
\hline
\textbf{2019  Mid-Cycle Adjustment 8/1/2019-10/31/2019} & \\
Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex]
\hline
31-Oct-19 &		-25	&	1.50 to 1.75\\	
Sept. 19, 2019&		-25&		1.75 to 2.0\\	
Aug. 1, 2019&		-25	& 2.0 to 2.25\\	
\hline			
\textbf{2020 Coping with Covid  11/01/2019 - 3/16/2020} & \\
Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex]
\hline
16-Mar-20&		-100&		0 to 0.25\\	
3-Mar-20&		-50&		1.0 to 1.25\\	
\hline	
\textbf{the zero lower bound (ZLB) 3/17/2020- 3/16/2022} & \\
Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex]
\hline
\textbf{2022 Taming Inflation 03/17/2022 - 12/29/2022} & \\
Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex]
\hline
14-Dec-22&		50&		4.25 to 4.50\\	
2-Nov-22&		75&		3.75 to 4.00\\	
21-Sep-22&		75&		3.00 to 3.25\\	
27-Jul-22&		75&		2.25 to 2.5\\	
16-Jun-22&		75&		1.5 to 1.75\\	
5-May-22&		50&		0.75 to 1.00\\	
17-Mar-22&		25&		0.25 to 0.50\\
\end{tabular}
\caption{FOMC rates changes 2018 to 2022}
\label{table:FOMCratechanges}
\end{table}
# ------------ create new section on MP, shocks, etc

We examine how these shocks, changes in monetary policy (Table \ref{table:FOMCratechanges}).affect rate volatility in different monetary policy regimes.


Monetary policy shocks
QE date for analysis
FIND DATES, link to table and figure above
TABLE of monetary policy decisions and events
CHECK:UPDATE TABLE DO!
\emph{Which epoch, Sep 2019, Mar 2020, series of QE}
2019
March 15, 2020
March 23, 2020
June 2020
December 2020 slow purchase
November 2021
December 2021



\begin{table}[h!]
\centering
\begin{tabular}{c c c} 
\hline
FOMC rates changes \\
%Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex] 
 \hline\hline
\textbf{2015 to 2018: Returning to Normalcy} & \\
Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex]
\hline
20-Dec-18 &	 25 &		2.25 to 2.50\\
Sept. 27, 2018 &		25 &		2.0 to 2.25\\
Jun. 14, 2018&		25 &		1.75 to 2.0\\	
22-Mar-18 &		25&		1.50 to 1.75\\	
Dec. 14, 2017 &		2&	5	1.25 to 1.50\\	
15-Jun-17&		25&		1.00 to 1.25\\	
16-Mar-17&		25 &		0.75 to 1.00\\	
Dec. 15, 2016 &		25 &		0.5 to 0.75\\
Dec. 17, 2015 &		25&		0.25 to 0.50\\
\hline
\textbf{2019  Mid-Cycle Adjustment} & \\
Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex]
\hline
31-Oct-19 &		-25	&	1.50 to 1.75\\	
Sept. 19, 2019&		-25&		1.75 to 2.0\\	
Aug. 1, 2019&		-25	& 2.0 to 2.25\\	
\hline			
\textbf{2020 Coping with Covid} & \\
Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex]
\hline
16-Mar-20&		-100&		0 to 0.25\\	
3-Mar-20&		-50&		1.0 to 1.25\\	
\hline		
\textbf{2022 Taming Inflation} & \\
Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex]
\hline
14-Dec-22&		50&		4.25 to 4.50\\	
2-Nov-22&		75&		3.75 to 4.00\\	
21-Sep-22&		75&		3.00 to 3.25\\	
27-Jul-22&		75&		2.25 to 2.5\\	
16-Jun-22&		75&		1.5 to 1.75\\	
5-May-22&		50&		0.75 to 1.00\\	
17-Mar-22&		25&		0.25 to 0.50\\
\end{tabular}
\caption{FOMC rates changes 2018 to 2022}
\label{table:FOMCratechanges}
\end{table}

Other events or shocks that affected ratesL

EVENTS
1) 96 9/16/2019 Repo spike SOHR 2.42 +13 over 9/15, EFFR 2.23 +11
   97 9/17/2019 Repo spike    SOFR 5+                  EFFR 2.3   
\url{https://www.federalreserve.gov/econres/notes/feds-notes/what-happened-in-money-markets-in-september-2019-20200227.html}
On Monday, September 16, SOFR printed at 2.43 percent, 13 basis points higher than the previous business day. With pressures in the repo market spilling over into the fed funds market, the EFFR printed at 2.25 percent, 11 basis points above the Friday print and at the top of the FOMC's target range. On September 17, the EFFR moved above the top of the target range to 2.3 percent and the SOFR increased to above 5 percent.


2) Mar 10-18 2020  Dash for cash 
121 3/8/2020 0:00 subtract 5 from coordinate
122 3/15/2020 0:00
The COVID-19 Pandemic Caused Market Disruptions across Sovereign Bond Markets
At the start of the COVID-19 pandemic in late February 2020, and in response to the economic repercussions of impending lockdown measures, investors began to demand higher-quality, safe assets. In particular, they shifted their portfolios toward sovereign bonds, and the resulting buying pressure drove sovereign yields to decline broadly. As the crisis intensified in March 2020, however, investors’ demand for cash surged, leading to selling pressure on sovereign bonds and therefore increases in their yields. This down-and-up pattern in yields is illustrated for ten-year U.S., German, U.K., and Japanese bonds in the chart below.
\url{https://libertystreeteconomics.newyorkfed.org/2022/07/the-global-dash-for-cash-in-march-2020/#:~:text=The$\%$20economic$\%$20disruptions$\%$20associated$\%$20with,number$\%$20of$\%$20central$\%$20bank$\%$20actions.}


-122 March 15, 2020 On March 15, 2020, the Fed shifted the objective of QE to supporting the economy. It said that it would buy at least $\$$500 billion in Treasury securities and  $\$$200 billion in government-guaranteed mortgage-backed securities over “the coming months.” 
 - 123 3/22/2020  March 23, 2020, it made the purchases open-ended, saying it would buy securities “in the amounts needed to support smooth market functioning and effective transmission of monetary policy to broader financial conditions,” expanding the stated purpose of the bond buying to include bolstering the economy. 

- June 2020 - In June 2020, the Fed set its rate of purchases to at least $\$$80 billion a month in Treasuries and  $\$$40 billion in residential and commercial mortgage-backed securities until further notice. 
 - December 2020 slow: The Fed updated its guidance in December 2020 to indicate it would slow these purchases once the economy had made “substantial further progress” toward the Fed’s goals of maximum employment and price stability. 
 - November 2021 taper: In November 2021, judging that test had been met, the Fed began tapering its pace of asset purchases by  $\$$10 billion in Treasuries and  $\$$5 billion in MBS each month. 
 - December 2021 double taper: At the subsequent FOMC meeting in December 2021, the Fed doubled its speed of tapering, reducing its bond purchases by  $\$$20 billion in Treasuries and  $\$$10 billion in MBS each month

December 2020 slow purchase
November 2021
December 2021
  Table and figures display changes in the Fed funds rate and the administered rates IOR and the reward rate ON RRP
Table \ref{table:FOMCratechanges} lists FOMC rates changes, monetary regimes, and events over the four year period, 2018-2022.
\begin{table}[h!]
\centering
\begin{tabular}{c c c} 
\hline
FOMC rates changes \\
%Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex] 
 \hline\hline
\textbf{2015 to 2018: Returning to Normalcy, mid cycle adjustment 3/4/2016 - 7/31/2019} & \\
Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex]
\hline
20-Dec-18 &	 25 &		2.25 to 2.50\\
Sept. 27, 2018 &		25 &		2.0 to 2.25\\
Jun. 14, 2018&		25 &		1.75 to 2.0\\	
22-Mar-18 &		25&		1.50 to 1.75\\	
Dec. 14, 2017 &		2&	5	1.25 to 1.50\\	
15-Jun-17&		25&		1.00 to 1.25\\	
16-Mar-17&		25 &		0.75 to 1.00\\	
Dec. 15, 2016 &		25 &		0.5 to 0.75\\
Dec. 17, 2015 &		25&		0.25 to 0.50\\
\hline
\textbf{2019  Mid-Cycle Adjustment 8/1/2019-10/31/2019} & \\
Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex]
\hline
31-Oct-19 &		-25	&	1.50 to 1.75\\	
Sept. 19, 2019&		-25&		1.75 to 2.0\\	
Aug. 1, 2019&		-25	& 2.0 to 2.25\\	
\hline			
\textbf{2020 Coping with Covid  11/01/2019 - 3/16/2020} & \\
Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex]
\hline
16-Mar-20&		-100&		0 to 0.25\\	
3-Mar-20&		-50&		1.0 to 1.25\\	
\hline	
\textbf{the zero lower bound (ZLB) 3/17/2020- 3/16/2022} & \\
Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex]
\hline
\textbf{2022 Taming Inflation 03/17/2022 - 12/29/2022} & \\
Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex]
\hline
14-Dec-22&		50&		4.25 to 4.50\\	
2-Nov-22&		75&		3.75 to 4.00\\	
21-Sep-22&		75&		3.00 to 3.25\\	
27-Jul-22&		75&		2.25 to 2.5\\	
16-Jun-22&		75&		1.5 to 1.75\\	
5-May-22&		50&		0.75 to 1.00\\	
17-Mar-22&		25&		0.25 to 0.50\\
\end{tabular}
\caption{FOMC rates changes 2018 to 2022}
\label{table:FOMCratechanges}
\end{table}
# ------------ create new section on MP, shocks, etc

We examine how these shocks, changes in monetary policy (Table \ref{table:FOMCratechanges}).affect rate volatility in different monetary policy regimes.


Monetary policy shocks
QE date for analysis
FIND DATES, link to table and figure above
TABLE of monetary policy decisions and events
CHECK:UPDATE TABLE DO!
\emph{Which epoch, Sep 2019, Mar 2020, series of QE}
2019
March 15, 2020
March 23, 2020
June 2020
December 2020 slow purchase
November 2021
December 2021



\begin{table}[h!]
\centering
\begin{tabular}{c c c} 
\hline
FOMC rates changes \\
%Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex] 
 \hline\hline
\textbf{2015 to 2018: Returning to Normalcy} & \\
Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex]
\hline
20-Dec-18 &	 25 &		2.25 to 2.50\\
Sept. 27, 2018 &		25 &		2.0 to 2.25\\
Jun. 14, 2018&		25 &		1.75 to 2.0\\	
22-Mar-18 &		25&		1.50 to 1.75\\	
Dec. 14, 2017 &		2&	5	1.25 to 1.50\\	
15-Jun-17&		25&		1.00 to 1.25\\	
16-Mar-17&		25 &		0.75 to 1.00\\	
Dec. 15, 2016 &		25 &		0.5 to 0.75\\
Dec. 17, 2015 &		25&		0.25 to 0.50\\
\hline
\textbf{2019  Mid-Cycle Adjustment} & \\
Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex]
\hline
31-Oct-19 &		-25	&	1.50 to 1.75\\	
Sept. 19, 2019&		-25&		1.75 to 2.0\\	
Aug. 1, 2019&		-25	& 2.0 to 2.25\\	
\hline			
\textbf{2020 Coping with Covid} & \\
Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex]
\hline
16-Mar-20&		-100&		0 to 0.25\\	
3-Mar-20&		-50&		1.0 to 1.25\\	
\hline		
\textbf{2022 Taming Inflation} & \\
Date & Change &(bps)	$\&$ Federal Funds Rate (pct) \\ [0.5ex]
\hline
14-Dec-22&		50&		4.25 to 4.50\\	
2-Nov-22&		75&		3.75 to 4.00\\	
21-Sep-22&		75&		3.00 to 3.25\\	
27-Jul-22&		75&		2.25 to 2.5\\	
16-Jun-22&		75&		1.5 to 1.75\\	
5-May-22&		50&		0.75 to 1.00\\	
17-Mar-22&		25&		0.25 to 0.50\\
\end{tabular}
\caption{FOMC rates changes 2018 to 2022}
\label{table:FOMCratechanges}
\end{table}

Other events or shocks that affected ratesL

EVENTS
1) 96 9/16/2019 Repo spike SOHR 2.42 +13 over 9/15, EFFR 2.23 +11
   97 9/17/2019 Repo spike    SOFR 5+                  EFFR 2.3   
\url{https://www.federalreserve.gov/econres/notes/feds-notes/what-happened-in-money-markets-in-september-2019-20200227.html}
On Monday, September 16, SOFR printed at 2.43 percent, 13 basis points higher than the previous business day. With pressures in the repo market spilling over into the fed funds market, the EFFR printed at 2.25 percent, 11 basis points above the Friday print and at the top of the FOMC's target range. On September 17, the EFFR moved above the top of the target range to 2.3 percent and the SOFR increased to above 5 percent.


2) Mar 10-18 2020  Dash for cash 
121 3/8/2020 0:00 subtract 5 from coordinate
122 3/15/2020 0:00
The COVID-19 Pandemic Caused Market Disruptions across Sovereign Bond Markets
At the start of the COVID-19 pandemic in late February 2020, and in response to the economic repercussions of impending lockdown measures, investors began to demand higher-quality, safe assets. In particular, they shifted their portfolios toward sovereign bonds, and the resulting buying pressure drove sovereign yields to decline broadly. As the crisis intensified in March 2020, however, investors’ demand for cash surged, leading to selling pressure on sovereign bonds and therefore increases in their yields. This down-and-up pattern in yields is illustrated for ten-year U.S., German, U.K., and Japanese bonds in the chart below.
\url{https://libertystreeteconomics.newyorkfed.org/2022/07/the-global-dash-for-cash-in-march-2020/#:~:text=The$\%$20economic$\%$20disruptions$\%$20associated$\%$20with,number$\%$20of$\%$20central$\%$20bank$\%$20actions.}


-122 March 15, 2020 On March 15, 2020, the Fed shifted the objective of QE to supporting the economy. It said that it would buy at least $\$$500 billion in Treasury securities and  $\$$200 billion in government-guaranteed mortgage-backed securities over “the coming months.” 
 - 123 3/22/2020  March 23, 2020, it made the purchases open-ended, saying it would buy securities “in the amounts needed to support smooth market functioning and effective transmission of monetary policy to broader financial conditions,” expanding the stated purpose of the bond buying to include bolstering the economy. 

- June 2020 - In June 2020, the Fed set its rate of purchases to at least $\$$80 billion a month in Treasuries and  $\$$40 billion in residential and commercial mortgage-backed securities until further notice. 
 - December 2020 slow: The Fed updated its guidance in December 2020 to indicate it would slow these purchases once the economy had made “substantial further progress” toward the Fed’s goals of maximum employment and price stability. 
 - November 2021 taper: In November 2021, judging that test had been met, the Fed began tapering its pace of asset purchases by  $\$$10 billion in Treasuries and  $\$$5 billion in MBS each month. 
 - December 2021 double taper: At the subsequent FOMC meeting in December 2021, the Fed doubled its speed of tapering, reducing its bond purchases by  $\$$20 billion in Treasuries and  $\$$10 billion in MBS each month

December 2020 slow purchase
November 2021
December 2021
  Table and figures display changes in the Fed funds rate and the administered rates IOR and the reward rate ON RRP
Table \ref{table:FOMCratechanges} lists FOMC rates changes, monetary regimes, and events over the four year period, 2018-2022.

# Time series properties/characteristics of overnight policy, interbank rates, transactions, and reserves held at the Federal Reserve
We examine the time series properties of overnight reference rates and their correspondence with the Federal Funds rate, the FOMC policy rate from 2016 through 2023.Transactions, reserves.


## Daily overnight rates 
From 2016, we see all overnight rates, EFFR, OBFR, TGFR, BGFR, SOFR? rising steadily from _ basis points in 2016 to_ July 2019 (see Figure \@ref(fig:Daily rates 2016-2022-plot).In 2019 rates began their decline in a 3 month period from August to October 2019. Rates then plunge with the onset of covid, from _ basis points in November 2019 to March 2020.  Rates plunge to near zero from Mar 2020 to March 022 during the zero lower bound. As the Fed began to fight inflation rates rose in steady 25 or 50 basis point increments from March 2022 to_ in December 2023.  Rates were held steady from _ basis points in 2016 to_  


The rate data from the Federal Reserve Data Download Program are average volume weighted medians and select percentiles. The median rather than the mean better represent daily rates since the data have outliers or extreme values. The median and interquartile range, the 75 percentile minus the 25 percentile, summarize a typical value and the variability in the sample.  The range of the data, the 99th ,minus the first percentile, is more sensitive to outliers.

(see  Figure \@ref(fig:Daily Secured rates 2016-2022-plot)

The average weighted median for the EFFR during the sample is 157 basis points (pb). The average weighted medians of other money market rates cluster around the median EFFR - TGCR,BGCR and SOFR 123-134 bp. Daily transaction volume in SOFR (billions of dollars ) is around 754 billion. The money market volumes in TGCR and BGCR around 300 billion.  Daily trade volume in EFFR is a low 79 billion.  The percentiles of rates reflect the same clustering around the EFFR and SOFR as do their medians.

>!--
Sample characteristics, weighted average  median values
                  EFFR    TGCR   BGCR      SOFR
Rates         & 156.97  & 132.83 & 132.85 & 134.32 \\ 
Volume        & 78.91   & 296.95 & 311.23 & 754.37 \\  
Percentile01  & 153.07  & 124.89 & 125.07 & 129.02 \\ 
Percentile25 _& 156.15  & 132.36 & 132.37 & 132.51 \\ 
Percentile75\_& 157.71  & 133.27 & 133.32 & 136.70 \\ 
Percentile99\_& 169.06  & 138.75 & 141.19 & 143.53 \\ 
--->

--->

The average weighted median for the EFFR during the sample is 157 basis points (pb). The average weighted medians of other money market rates cluster around the median EFFR - TGCR,BGCR and SOFR 123-134 bp. Daily transaction volume in SOFR (billions of dollars ) is around 754 billion. The money market volumes in TGCR and BGCR around 300 billion.  Daily trade volume in EFFR is a low 79 billion.  The percentiles of rates reflect the same clustering around the EFFR and SOFR as do their medians.

The interquartile range for the money market rates TGCR and BGCR are under 1 bp, smaller than the 1.56 bp of the policy rate, EFFR. The SOFR has the largest IQR, some 4.2 bp. The OBFR,designed to track the policy rate. is similar to the EFFR.

The range of the data, the 9th ,minus the first percentile, is more sensitive to outliers/ Some 14 to 16 basis points for the EFFR and the money market rates, TGCR, BGCR, and SOFR. 


>!--
\url{https://www.sciencedirect.com/topics/computer-science/interquartile-range}
Since the data are average weighed median values, measures of dispersion. the spread around a central tendency,  are the interquartile range (the 75th minus the 25 percentile, ), and the range (the 99th minus the one percentile).
When there are no outliers in a sample, the mean and standard deviation are used to summarize a typical value and the variability in the sample. When a data set has outliers, variability is often summarized by The interquartile range, which the difference between the first and third quartiles, mumarizes the variability when outliers are present in the data.Tukey Fenceshelp
discribe outliers in a sample. Outliers are values below Q1-1.5(Q3-Q1) or above Q3+1.5(Q3-Q1) or equivalently, values below Q1-1.5 IQR or above Q3+1.5 IQR.

The interquartile range indicates how spread out is the middle 50% of the data. The interquartile range unlike the range is not sensitive to outliers. The range, the 99th percentile minus the one percentile, a simple measure of variability, is sensitive to outliers.

Estimating moments of the data show overnight rates are highly skewed with fatter tails.

The interquartile range for the money market rates TGCR and BGCR are under 1 bp, smaller than the 1.56 bp of the policy rate, EFFR. The SOFR has the largest IQR, some 4.2 bp. The OBFR,designed to track the policy rate. is similar to the EFFR.

The range of the data, the 9th ,minus the first percentile, is more sensitive to outliers/ Some 14 to 16 basis points for the EFFR and the money market rates, TGCR, BGCR, and SOFR. 

>!--
        Median   IQR    Range
EFFR & 156.97  & 1.56 & 15.99 \\
OBFR & 156.28  & 1.94 & 23.16 \\ 
TGCR & 132.83  & 0.92 & 13.86 \\  
BGCR & 132.85  & 0.96 & 16.11 \\  
SOFR & 134.32  & 4.20 & 14.51 \\ 

& Category & Median & IQR & RANGE \\ 
  \hline
  EFFR & EFFR & 156.97 & 1.56 & 15.99 \\ 
  OBFR & OBFR & 156.28 & 1.94 & 23.16 \\ 
  TGCR & TGCR & 132.83 & 0.92 & 13.86 \\ 
  BGCR & BBGCR & 132.85 & 0.96 & 16.11 \\ 
  SOFR & SOFR & 134.32 & 4.20 & 14.51 \\ 
--->

```{r, 
# Sample data in two lists
categories = c('EFFR', 'OBFR', 'TGCR', 'BBGCR', 'SOFR')
median_values = c(Estats[1], Ostats[1], Tstats[1], Bstats[1], Sstats[1])
iqr_values =  c(Estats[7] - Estats[6], Ostats[5] - Ostats[4], Tstats[5] - Tstats[4], Bstats[5] - Bstats[4], Sstats[5] - Sstats[4])
range_values = c(Estats[8] - Estats[5], Ostats[6] - Ostats[3], Tstats[6] - Tstats[3], Bstats[6] - Bstats[3], Sstats[6] - Sstats[3])
samplestats <- data.frame(Category = categories, Median = median_values, IQR = iqr_values, RANGE = range_values)
```

```{r, 
knitr::kable(samplestats, caption = "Key statistics rates 2016-2023")
```

```{r, sample statsdata, echo=FALSE}
# Sample data in two lists
categories = c('EFFR', 'OBFR', 'TGCR', 'BBGCR', 'SOFR')
median_values = c(Estats[1], Ostats[1], Tstats[1], Bstats[1], Sstats[1])
iqr_values = c(Estats[8] - Estats[7], Ostats[6] - Ostats[5], Tstats[6] - Tstats[5], Bstats[6] - Bstats[5], Sstats[8] - Sstats[7])
range_values = c(Estats[9] - Estats[6], Ostats[7] - Ostats[4], Tstats[7] - Tstats[4], Bstats[7] - Bstats[4], Sstats[9] - Sstats[6])
samplestats <- data.frame(Category = categories, Median = median_values, IQR = iqr_values, RANGE=range_values)
samplestats2 <- xtable(samplestats)
print(samplestats2)
```

```{r. sample stats, echo=FALSE}
knitr::kable(samplestats, caption = "Key statistics rates 2016-2023")
```
```{r. sample characteristics, echo=FALSE}
knitr::kable(samplestats, caption = "Descriptive  rates 2016-2023")
```

<!--
#NO! inflation   5/5/2022		12/29/2022 1517  1714
# Redo -3 for each position for nrow=1710
line 964 in code
norm_sdate <- sdate[1:856]
adj_sdate <- sdate[857:920]
covid_sdate <- sdate[921:1029]
zlb_sdate <- sdate[1030:1513]
inflation_sdate <- sdate[1514:1710]
-->

<!--
Reference figures
See Figure \@ref(fig:cars-plot).
 Figure \@ref(fig:Daily rates 2016-2022-plot)
 Figure \@ref(fig:Daily Secured rates 2016-2022-plot)
 Figure \@ref(fig:EFFR, FOMC targets 2016-2023-plot
```{r cars-plot, fig.cap="The cars data.", echo=FALSE}
par(mar = c(4, 4, .2, .1))
plot(cars)  # a scatterplot
```
--->

```{r, fig.cap= "Daily rates 2016-2023", echo=FALSE, warning=FALSE, message=FALSE, fig.height=6, fig.width=8, eval=TRUE, cache=FALSE, dev='png', out.width='80%', , results='hide', fig.pos='H'}  
y_breaks=25
y_limits=400
meltrrbp <- melt(rrbp,id="sdate")
 rates <- ggplot(meltrrbp,aes(x=sdate,y=value,colour=variable,group=variable)) + 
   geom_point(size = 1) +
   labs(x="Date",  y = "Basis Points (bp)", color = "Rate", shape = "Rate") +  
   scale_y_continuous(breaks = seq(0, 500, by = 50), limits = c(0, 500)) + 
   theme_minimal() + 
  guides(shape = guide_legend(title = "Rate"))
   print(rates)
```


```{r,fig.cap= "Daily secured rates", echo=FALSE, warning=FALSE, message=FALSE, fig.height=6, fig.width=8, eval=TRUE, cache=FALSE, dev='png', out.width='80%', , results='hide', fig.pos='H'}  
meltsecured <- melt(secured,id="sdate")
 securedrates <- ggplot(meltsecured,aes(x=sdate,y=value,colour=variable,group=variable)) + 
   geom_point(size = 1) +
   labs(x="Date",  y = "Basis Points (bp)", color = "Rate", shape = "Rate") +  
   scale_y_continuous(breaks = seq(0, 500, by = 50), limits = c(0, 500)) + 
   theme_minimal() +
  guides(shape = guide_legend(title = "Rate"))
 print(securedrates)
```


```{r, effr quantiles,, echo=FALSE}
#Access the data frame stored in the environment
my_effr <- my_enveffr$melteffr
``` 


```{r,fig.cap= "EFFR, FOMC targets 2016-2023",echo=FALSE}
quantilesE2 = subset( quantilesE, select = -c(Volume_EFFR,Percentile01_EFFR,Percentile99_EFFR))
 melteffr <- melt(quantilesE2,id="sdate")
 quantileseffr <- ggplot(melteffr,aes(x=sdate,y=value,colour=variable,group=variable)) + 
   geom_point(shape = 16, size = 1) +
   labs(x="Date",  y = "Basis Points (bp)", color = "Rate", shape = "Rate") +  
   scale_y_continuous(breaks = seq(0, 500, by = 50), limits = c(0, 500)) + 
   theme_minimal() + guides(shape = guide_legend(title = "Rate"))
 print(quantileseffr)
```

```{r, sofr quantiles, echo=FALSE}
#Access the data frame stored in the environment
my_sofr <- my_envsofr$meltsofr
``` 

 (see Figure \@ref(fig:SOFR, FOMC targets 2016-2023-plot)
```{r, fig.cap= "SOFR, FOMC targets 2016-2023", echo=FALSE}
quantilesS2 = subset( quantilesS, select = -c(Volume_SOFR, TargetUe_SOFR, TargetDe_SOFR,Percentile01_SOFR, Percentile99_SOFR) ) 
 meltsofr <- melt(quantilesS2,id="sdate")
 quantilessofr <- ggplot(meltsofr,aes(x=sdate,y=value,colour=variable,group=variable)) + geom_point(shape = 16, size = 1)+
   labs(x="Date", y = "Basis Points (bp)", color = "Rate", shape = "Rate") +   
   theme_minimal() + guides(shape = guide_legend(title = "Rate"))
   # + theme(axis.title.x=element_blank(), axis.text.x= element_text(size=8,vjust =.5))
 print(quantilessofr)
```


#data chunks for sample stats ----------------------------------------
```{r, sample data description, echo=FALSE}
numeric_quantilesE <- select_if(quantilesE, is.numeric)
Estats <- colMeans(numeric_quantilesE, na.rm = TRUE)

numeric_quantilesO <- select_if(quantilesO, is.numeric)
Ostats <- colMeans(numeric_quantilesO, na.rm = TRUE)

numeric_quantilesS <- select_if(quantilesS, is.numeric)
Sstats <- colMeans(numeric_quantilesS, na.rm = TRUE)

numeric_quantilesT <- select_if(quantilesT, is.numeric)
Tstats <- colMeans(numeric_quantilesT, na.rm = TRUE)

numeric_quantilesB <- select_if(quantilesB, is.numeric)
Bstats <- colMeans(numeric_quantilesB, na.rm = TRUE)

numeric_quantilesO <- select_if(quantilesO, is.numeric)
Ostats <- colMeans(numeric_quantilesO, na.rm = TRUE)

selected_columnsE <- Estats[c("EFFR","Volume_EFFR","Percentile01_EFFR", "Percentile25_EFFR","Percentile75_EFFR","Percentile99_EFFR")]
selected_columnsS <- Sstats[c("SOFR","Volume_SOFR","Percentile01_SOFR", "Percentile25_SOFR","Percentile75_SOFR","Percentile99_SOFR")]
sampleschar <- data.frame(selected_columnsE, Tstats,Bstats,selected_columnsS)
samplechar2 <- xtable(sampleschar)
print(samplechar2, include.rownames = TRUE)
#str(samplechar)
```
<!--
histograms, densities, boxplots
-->

## Transaction volumes
## Reserves
Total reserves in the U. S. banking system now exceed  $\$$3.081237 trillion (Totresns). At the beginning of 2009, reserves were $\$$800 billion, compared to approximately $\$$10 billion pre-crisis. Reserves continued to increase until late 2014. Fed’s quantitative easing programs raised reserves to  a peak of $\$$2.8 trillion in September 2014.  Peak reserves peaked $\$$4.275 at then end of 2021 In November 2022, From late 2017, when the Federal Open Market Committee began implementing its policy of “balance sheet normalization” aggregate reserves began to decline, reaching a low of $\$$1.4 trillion in early September 2019 (Table \ref{table:weeklyreserves}, Figure \ref{fig:weeklyreserves}). 

During 2016 and 2017 reserves were $\$$180 to $\$$200 million reaching a low of $\$$160 million on 1/4/2017 (Table ~\ref{table:statsweeklyratesannual}).
During the initial years of the sample from 3/02/2016 until. reserves were around $\$$200 million until 9/28/2016 when reserves fell to $\$$180 million. Then returned to $\$$200 million on 2/15/2017 until  6/24/2018 

From 7/28/2017 to 6/24/2018, volume weighted median overnight money market rates are higher and normalized reserves are low,  0.19 or $\$$190 million  the week of 7/26/2017 (Figure \ref{figure:vmrates}). All rates reach a maximum at the end of June or first week of July 2018. The EFFR and OBFR reach their maximum value 179.56  and 387.74 basis points respectively during the week 6/24/2018.  The money market rates TGCR, BGCR, and SOFR reach their maxima the following  week 7/1/2018,  Reserves per deposits fell to 0.16 or $\$$160 million on 6/27/2018. All rates then decline, reaching their lowest level 4/5/2020 just as reserves begin to increase to 0.18 or or $\$$180 million . The EFFR reaches a low of 1.74 basis points. Reserves increase from  4/5/2020 to 9/15/2021, 0.24 or $\$$240 million then begin to decline.  From 3/13/2022 to the present, all rates rise steeply with the successive increases in the Fed policy rate response to inflation. The EFFR rises on 3/13/2022 from 1,74 to	27.36 basis points. Reserves decline slightly to 0.17 or $\$$170 million at the end of the sample 12/29/2022 (revise data)

The level of reserves in the banking system can change either because
1) the Federal Reserve buys or sells assets from banks, which changes the size of the Federal Reserve
balance sheet
2) because funds are transferred between reserves and non-reserve accounts at the Federal
example \url{https://www.moneyandbanking.com/commentary/2020/11/8/the-case-of-the-treasury-account-at-the-federal-reserve}
\ref{figure} Figure \@ref(fig:FedLiabilties).
3) The Federal Reserve responds to volatility in the federal funds market by adjusting the reserve
supply to keep the federal funds rate within its target range through repo and reverse repo operations each day


The Federal Reserve changes the level of aggregate reserves by trading securities with banks.
Federal Reserve purchases add assets to its balance sheet and issues reserves by crediting the Federal

Temporary open market operations (TOMO), short-term repurchase and reverse repurchase agreements,
support the Fed’s policy objectives for the desired range of the effective Federal Funds rate.
Short-term repurchase and reverse repurchase agreements are designed to temporarily add or drain
reserves available to the banking system and influence day-to-day trading in the Federal Funds market.

Reserve accounts of the selling banks. (reverse repo, Fed is lender?)
In a repo transaction, the Federal Reserve sells securities to banks. Aggregate reserves decline when the Fed debits the Federal Reserve accounts of the selling banks. (Fed repo as borrower)?
The trading desk at the NY Fed dpnducts all repo and reverse repo operations, including small value exercises. https://www.newyorkfed.org/markets/desk-operations/

In a repo transaction, the Desk purchases securities from a counterparty subject to an agreement to resell the securities at a later date, temporarily increasing the supply of reserve balances in the banking system and lowering the EFFR.

In a repo transaction, the Desk purchases securities from a counterparty subject to an agreement
to resell the securities at a later date. Each repo transaction is economically similar to a loan collateralized
by securities, and temporarily increases the supply of reserve balances in the banking system.
Conversely, in a reverse repo transaction, the Desk sells securities to a counterparty subject to an
agreement to repurchase the securities at a later date. Reverse repo transactions temporarily reduce the
supply of reserve balances in the banking system.
The repo rate. interest” paid on that loan., is the difference between the original price and the
second, higher price, Participants include

When the Federal Reserve lends to counter parties in a reverse repo transaction, the Fed sale of securities lower aggregate reserves as funds are debited from depositor accounts. These operations are quick and are put in place within a matter of days. For example, in September 2019, the federal funds rate spiked up on September 16 and 17. On September 18-21 ... and dash for cash March 2020. Counterparties that lend to the Fed include primary dealers, hedge funds, insurance firms, money markets and financial firms with large pools of cash . CHECK





```{r, Fed liabilities, echo=FALSE}
#recreate from FRED 
#Composition of Federal Reserve liabilities (Percent of total), 2007-2020
#Note: All data are for the annual averages of weekly data, except for 2020, which is for end-October. #Source: FRED and Federal Reserve H.4.1.
```



the Treasury keeps an account at the Fed  or deposits in Treasury Tax and Loan (TT&L) accounts at commercial banks to provide a buffer to avoid payment issues.

A Treasury deposit reduces reserves in the banking system. A decrease in government deposits adds reserves.Prior to 2008, when reserve levels were very low, a change of $1 billion could move interbank lending rates substantially. To avoid unpleasant surprises, the Treasury and the Fed agreed to target an account level of $5 billion at the end of every business day. If the government thought they would miss, officials would alert the Fed staff in the morning so that they could use open-market operations to adjust. 

When the target was $5 billion and the Fed’s liabilities were a relatively modest $750 billion, Treasury deposits accounted for less than 1 percent of the total. In the decade starting in 2008, Treasury balances rose to around $400 billion, accounting for an average of 5% of Fed liabilities. Since June 2020, Treasury deposits at the Fed now account 23 percent of total liabilities. 

The level of reserves in the banking system can change either because
1) the Federal Reserve buys or sells assets from banks, which changes the size of the Federal Reserve
balance sheet
2) because funds are transferred between reserves and non-reserve accounts at the Federal
3) The Federal Reserve responds to volatility in the federal funds market by adjusting the reserve
supply to keep the federal funds rate within its target range through repo and reverse repo operations each day
The Federal Reserve changes the level of aggregate reserves by trading securities with banks.
Federal Reserve purchases add assets to its balance sheet and issues reserves by crediting the Federal

Temporary open market operations (TOMO), short-term repurchase and reverse repurchase agreements,
support the Fed’s policy objectives for the desired range of the effective Federal Funds rate.
Short-term repurchase and reverse repurchase agreements are designed to temporarily add or drain
reserves available to the banking system and influence day-to-day trading in the Federal Funds market.

Reserve accounts of the selling banks. (reverse repo, Fed is lender?)
In a repo transaction, the Federal Reserve sells securities to banks. Aggregate reserves decline when the Fed debits the Federal Reserve accounts of the selling banks. (Fed repo as borrower)?
The trading desk at the NY Fed dpnducts all repo and reverse repo operations, including small value exercises. https://www.newyorkfed.org/markets/desk-operations/

In a repo transaction, the Desk purchases securities from a counterparty subject to an agreement to resell the securities at a later date, temporarily increasing the supply of reserve balances in the banking system and lowering the EFFR.

In a repo transaction, the Desk purchases securities from a counterparty subject to an agreement
to resell the securities at a later date. Each repo transaction is economically similar to a loan collateralized
by securities, and temporarily increases the supply of reserve balances in the banking system.
Conversely, in a reverse repo transaction, the Desk sells securities to a counterparty subject to an
agreement to repurchase the securities at a later date. Reverse repo transactions temporarily reduce the
supply of reserve balances in the banking system.
The repo rate. interest” paid on that loan., is the difference between the original price and the
second, higher price, Participants include


When the Federal Reserve lends to counter parties in a reverse repo transaction, the Fed sale of securities lower aggregate reserves as funds are debited from depositor accounts. These operations are quick and are put in place within a matter of days. For example, in September 2019, the federal funds rate spiked up on September 16 and 17. On September 18-21 ... and dash for cash March 2020. Counterparties that lend to the Fed include primary dealers, hedge funds, insurance firms, money markets and financial firms with large pools of cash . CHECK

<!--
In a repo transaction, the Federal Reserve sells securities to banks. Aggregate reserves decline when the Fed debits the Federal Reserve accounts of the selling banks. (Fed repo as borrower)?
The trading desk at the NY Fed dpnducts all repo and reverse repo operations, including small value exercises. https://www.newyorkfed.org/markets/desk-operations/

In a repo transaction, the Desk purchases securities from a counterparty subject to an agreement to resell the securities at a later date, temporarily increasing the supply of reserve balances in the banking system and lowering the EFFR.

The repo rate. . Each repo transaction is economically similar to a loan collateralized by securities,interest” paid on that loan, is the difference between the original price and the second, higher price. In a reverse repo transaction, the Desk sells securities to a counterparty subject to an agreement to repurchase the securities at a later date.  temporarily decreases the supply of reserve balances in the banking system and raising the FFR

The increases in SOFR volumes dwarf the EFFR  increased 068  %268 in 2019 and 878 in 2022. SOFR volumes fell 682 in 2020 and 292 in 2021. Daily SOFR trading volumes, $\$1.1$ trillion
dwarf the Federal funds market, $\$62.5$ billion.
(2020? Gibbs CME webinar on repo).
Counterparties that lend to the Fed include money markets and dealers. 

In the recently established repo facility n July 2021, the Standing Repo Facility (SRF), the Desk purchases securities from a counterparty subject to an agreement to repurchase the securities at a later date,  temporarily increases the supply of reserve balances in the banking system and lowers the FFR. The repo rate. . Each repo transaction is economically similar to a loan collateralized by securities,interest” paid on that loan, is the difference between the original price and the second, higher price. In a reverse repo transaction, the Desk sells securities to a counterparty subject to an agreement to repurchase the securities at a later date.  temporarily decreases the supply of reserve balances in the banking system and raising the FFR.


The FOMC planned reduction of holdings of these securities,’balance sheet normalization’, began October 2017, by holding them to maturity, rather than by selling them back in financial markets. This reduction of reserves engendered a disruption in repurchase (repo) markets in September 2019. To resolve this crisis, In October 2019, the Fed resumed purchasing massive amounts of debt securities.

Reserve, which changes the composition of the Federal Reserve’s liabilities keeping the size of the balance
sheet constant.
The quantitative easing asset purchases, QE1, QE2, and QE3, challenged the Federal Reserve bank’s ability to control short-term interest rates. As a result, the Fed and other central banks changed their overall frameworks for controlling short-term interest rates. Pre-crisis, these frameworks were typically based on adjusting the scarcity value of a limited supply of central bank deposits (reserves), but the substantial increase in liquidity resulting from asset purchases in response to the crisis made other techniques necessary
(Hypothesis 1 continued see rmd 7/35/2023
With weekly data on reserves, rates are higher when reserves are low, and the converse when reserves are high or 'ample' (Tables \ref{tab;e:weeklyreserves and \ref{table:statsweeklyratesannual}}). Daily reserve data are available only to Federal Reserve staff, NYFed staff recommended this analysis use  the weekly series of reserves Reserve Balances with Federal Reserve Banks: Week Average (WRESBAL) $\$S$ billions normalized by deposits of commercial banks (DPSACBW027SBOG) $\$S$ billions to control for the growth of the banking industry. Both weekly series ending on Wednesday.



## Episodes that suggest different policy regines
(see Figure \@ref(fig:EFFR, FOMC targets 2016-2023-plot)
The pattern in rate data from 2016 t0 2023 suggests the following episodes that may correspond with differing policy regimes or external shocks:

1. normalcy   3/4/2016		7/31/2019      4  859
2. mid cycle adjustment 8/1/2019 - 10/31/2019 737660  860 - 923
3. covid 11/1/2019	    3/16/2020   924  1032
4. zlb         3/17/2020- 3/16/2022     1032-1516
5. Taming inflation 03/17/2022 - 12/14/2023 1517-1960  Correct with new end point

This breakdown is derived from visual inspection of the data and the corresponsing policy changes (TABLE?) during each period.  A more rigorous approach to identifying change in regimes is offered by (Valeria Gargiulo, Christian Matthes, and Katerina Petrova,2024) 
Monetary Policy across Inflation Regimes
Valeria Gargiulo, Christian Matthes, and Katerina Petrova
Federal Reserve Bank of New York Staff Reports, no. 1083
January 2024
https://doi.org/10.59576/sr.1083

```{r, episodes, echo=FALSE}
begn<- c(1, 857, 921,  1030, 1514, 1)
endn<- c(856, 920, 1029, 1513, 1711, 1710)
k<-1
norm<-rrbp[begn[k]:endn[k],]
K<-2
adjust<-rrbp[begn[k]:endn[k],]
K<-3
covid<-rrbp[begn[k]:endn[k],]
K<-4
zlb<-rrbp[begn[k]:endn[k],]
K<-5
inflation<-rrbp[begn[k]:endn[k],]
```
```{r, normalcy, echo=FALSE}
#1. normalcy   3/4/2016		7/31/2019      4  859
k=1
bgn<-begn[k]
edn<-endn[k]
norm<-rrbp[bgn:edn,]
qnormE=quantilesE[bgn:edn,]
Estatsnorm <- colMeans(numeric_quantilesE[bgn:edn,], na.rm = TRUE)
Ostatsnorm <- colMeans(numeric_quantilesO[bgn:edn,], na.rm = TRUE)
Tstatsnorm <- colMeans(numeric_quantilesT[bgn:edn,], na.rm = TRUE)
Bstatsnorm <- colMeans(numeric_quantilesB[bgn:edn,], na.rm = TRUE)
Sstatsnorm <- colMeans(numeric_quantilesS[bgn:edn,], na.rm = TRUE)
```

 (see Figure \@ref(fig:EFFR during normalcy period  3/4/2016-7/31/2019-plot)
```{r, fig.cap= "EFFR during normalcy period  3/4/2016-7/31/2019"}
#norm2 = subset(norm, select = -c(sdate2)) 
meltrates_norm <- melt(norm,id="sdate")
rates_norm <- ggplot(meltrates_norm,aes(x=sdate,y=value,colour=variable,group=variable)) + 
  geom_line() +
  labs(x="Date", y = "Basis Points (bp)", color = "Rate", linetype = "Rate") +  
  scale_y_continuous(breaks = seq(0, 350, by = 25), limits = c(0, 350)) + 
  theme_minimal()
#theme(axis.title.x=element_blank(), axis.text.x= element_text(size=8,vjust =.5),plot.tag = element_text(size=8,hjust = 0),plot.tag.position = c(0.5,-.01))
print(rates_norm)
```

# episode characteristics
```{r, norm characteristics,echo=FALSE} 
selected_columnsE<- Estatsnorm[c("EFFR","Volume_EFFR","Percentile01_EFFR", "Percentile25_EFFR","Percentile75_EFFR","Percentile99_EFFR")]
 normchar <- rbind(selected_columnsE, Tstatsnorm,Bstatsnorm,Sstatsnorm)
 normchar2 <- xtable(normchar)
 print(normchar2)
```
```{r, norm char table,echo=FALSE} 
print(normstats)
```
The average weighted median for the EFFR during the nomrmalcy period is 124 basis points (pb). The average weighted medians of other money market rates cluster around the median EFFR - TGCR,BGCR and SOFR 84-85 bp. Daily transaction volume in SOFR (billions of dollars ) is around 350 billion. The money market volumes in TGCR and BGCR around 158-166 billion.  Daily trade volume in EFFR is a low 76 billion.  The percentiles of rates reflect the same clustering around the EFFR and SOFR as do their medians.

The interquartile range for the money market rates TGCR and BGCR are 0.22-0,23 bp, smaller than the 1.22 bp of the policy rate, EFFR. The SOFR has the largest IQR, some 3.3 bp. The OBFR,designed to track the policy rate. is similar to the EFFR.

The range of the data, the 9th ,minus the first percentile, is more sensitive to outliers/ Some 17.65 basis points for the EFFR and 5.62-8.53the money market rates, TGCR, BGCR, and SOFR. 
<!--
norm ----------------------------------------------------------------
selected_columnsE 133.78904    75.86364         129.37646         133.32634         134.54662
Tstatsnorm         83.82984   158.52564          79.88345          83.43823          83.65618
Bstatsnorm         83.83566   166.42075          79.96620          83.45221          83.68298
Sstatsnorm         85.34499   350.22028          81.43706          83.54779          86.84848
                  Percentile99_EFFR
selected_columnsE         147.02331
Tstatsnorm                 85.50350
Bstatsnorm                 88.44172
Sstatsnorm                 89.96853

& Category & Median & IQR & RANGE \\ 
  \hline
  EFFR & EFFR & 133.79 & 1.22 & 17.65 \\ 
  OBFR & OBFR & 133.53 & 1.65 & 29.89 \\ 
  TGCR & TGCR & 83.83 & 0.22 & 5.62 \\ 
  BGCR & BBGCR & 83.84 & 0.23 & 8.48 \\ 
  SOFR & SOFR & 85.34 & 3.30 & 8.53 \\ 


The average weighted median for the EFFR during the nomrmalcy period is 157 basis points (pb). The average weighted medians of other money market rates cluster around the median EFFR - TGCR,BGCR and SOFR 123-134 bp. Daily transaction volume in SOFR (billions of dollars ) is around 754 billion. The money market volumes in TGCR and BGCR around 300 billion.  Daily trade volume in EFFR is a low 79 billion.  The percentiles of rates reflect the same clustering around the EFFR and SOFR as do their medians.

The interquartile range for the money market rates TGCR and BGCR are under 1 bp, smaller than the 1.56 bp of the policy rate, EFFR. The SOFR has the largest IQR, some 4.2 bp. The OBFR,designed to track the policy rate. is similar to the EFFR.

The range of the data, the 9th ,minus the first percentile, is more sensitive to outliers/ Some 14 to 16 basis points for the EFFR and the money market rates, TGCR, BGCR, and SOFR. 

Adjust--------------------------------
 & EFFR & Volume\_EFFR & Percentile01\_EFFR & Percentile25\_EFFR & Percentile75\_EFFR & Percentile99\_EFFR \\ 
  \hline
selected\_columnsE & 200.09 & 66.84 & 192.08 & 197.25 & 201.91 & 209.75 \\ 
  Tstatsadj & 206.30 & 466.22 & 191.66 & 205.62 & 206.92 & 214.36 \\ 
  Bstatsadj & 206.34 & 492.47 & 191.80 & 205.62 & 206.98 & 225.80 \\ 
  Sstatsadj & 208.22 & 1151.00 & 196.47 & 206.00 & 216.53 & 237.73 \\ 

 & Category & Median & IQR & RANGE \\ 
EFFR & EFFR & 200.09 & 4.66 & 17.67 \\ 
  OBFR & OBFR & 197.84 & 6.55 & 40.53 \\ 
  TGCR & TGCR & 206.30 & 1.30 & 22.70 \\ 
  BGCR & BBGCR & 206.34 & 1.36 & 34.00 \\ 
  SOFR & SOFR & 208.22 & 10.53 & 41.27 \\ 

The average weighted median for all over night rates are tightly clustered around 148.64-151.18c during covid. The average weighted medians of other money market rates cluster around the median EFFR - TGCR,BGCR and SOFR 123-134 bp. Daily transaction volume in SOFR (billions of dollars ) is around 1086 billion. The money market volumes in TGCR and BGCR around 402-423  billion.  Daily trade volume in EFFR is a low 71.7 billion.  The percentiles of rates reflect the same clustering around the EFFR and SOFR as do their medians.

The interquartile range for the money market rates TGCR and BGCR are under 1 bp, smaller than the 1.56 bp of the policy rate, EFFR. The SOFR has the largest IQR, some 4.2 bp. The OBFR,designed to track the policy rate. is similar to the EFFR.

The range of the data, the 9th ,minus the first percentile, is more sensitive to outliers/ Some 14 to 16 basis points for the EFFR and the money market rates, TGCR, BGCR, and SOFR. 
  
Covid---------------------------------
 EFFR & Volume\_EFFR & Percentile01\_EFFR & Percentile25\_EFFR & Percentile75\_EFFR & Percentile99\_EFFR \\ 
  \hline
selected\_columnsE & 150.46 & 71.70 & 145.80 & 149.53 & 151.88 & 157.52 \\ 
  Tstatscovid & 148.64 & 401.74 & 142.08 & 148.47 & 148.78 & 153.29 \\ 
  Bstatscovid & 148.64 & 423.19 & 142.30 & 148.47 & 148.89 & 158.32 \\ 
  Sstatscovid & 151.19 & 1085.60 & 145.62 & 148.71 & 156.09 & 165.08 \\ 
 
 
 SAME AS ZLB??
  & Category & Median & IQR & RANGE \\
  EFFR & EFFR & 150.46 & 2.35 & 11.71 \\ 
  OBFR & OBFR & 149.75 & 2.62 & 25.95 \\ 
  TGCR & TGCR & 148.64 & 0.31 & 11.21 \\ 
  BGCR & BBGCR & 148.64 & 0.42 & 16.02 \\ 
  SOFR & SOFR & 151.19 & 7.37 & 19.46 \\ 
  
  
  The average weighted median for the EFFR during the zero lower bound is 8 basis points (pb). The average weighted medians of other money market rates cluster around the median EFFR - TGCR,BGCR and SOFR? 4,6 bp. Daily transaction volume in SOFR (billions of dollars ) is around 754 billion. The money market volumes in TGCR and BGCR around 353-376 billion.  Daily trade volume in EFFR is a low 69 billion.  The percentiles of rates reflect the same clustering around the EFFR and SOFR as do their medians.

The interquartile range for the money market rates TGCR and BGCR are .12-.15 bp, smaller than the 1.54 bp of the policy rate, EFFR. The SOFR has the largest IQR, some 4.2 bp. The OBFR,designed to track the policy rate. is similar to the EFFR.

The range of the data, the 9th ,minus the first percentile, is more sensitive to outliers, Some 11 to 12 basis points for  the money market rates, TGCR, BGCR 7.33 for the EEFR and 14.44 for SOFR. 

zlb-----------------------------------
                        EFFR Volume_EFFR Percentile01_EFFR Percentile25_EFFR Percentile75_EFFR
selected_columnsE   8.085149    68.96832          5.069307          7.130693          8.671287
Tstatszlb           4.586139   353.60396          2.079208          4.520792          4.645545
Bstatszlb           4.588119   376.31881          2.051485          4.526733          4.673267
Sstatszlb         ?364.066059  1199.93622        355.364465        362.034169        367.712984
                  Percentile99_EFFR
selected_columnsE          12.40198
Tstatszlb                  13.29109
Bstatszlb                  13.91089
Sstatszlb                 376.71754
 & Category & Median & IQR & RANGE \\ 
  \hline
  
   & Category & Median & IQR & RANGE \\ 
  \hline
  EFFR & EFFR & 8.09 & 1.54 & 7.33 \\ 
  OBFR & OBFR & 7.17 & 1.47 & 13.58 \\ 
  TGCR & TGCR & 4.59 & 0.12 & 11.21 \\ 
  BGCR & BBGCR & 4.59 & 0.15 & 11.86 \\ 
  SOFR & SOFR & 5.41 & 3.05 & 14.44 \\ 
  
The average weighted median for the EFFR during the inflation targeting regime is 368 basis points (pb). The average weighted medians of other money market rates cluster around the median EFFR - TGCR,BGCR and SOFR 362-364 bp. Daily transaction volume in SOFR (billions of dollars ) is around 1200 billion. The money market volumes in TGCR and BGCR around 456to 470  billion.  Daily trade volume in EFFR is a low 100 billion.  The percentiles of rates reflect the same clustering around the EFFR and SOFR as do their medians.

The interquartile range for the money market rates TGCR and BGCR are 3.26-3.46 bp, smaller than the 1.62 bp of the policy rate, EFFR. The SOFR has the largest IQR, some 5.68 bp. The OBFR,designed to track the policy rate. is similar to the EFFR.

The range of the data, the 9th ,minus the first percentile, is more sensitive to outliers,  Some 23 basis points for the EFFR and 21 for SOFR and the money market rates, TGCR, BGCR, 32-33. 

Inflation------------------------------
& EFFR & Volume\_EFFR & Percentile01\_EFFR & Percentile25\_EFFR & Percentile75\_EFFR & Percentile99\_EFFR 
 EFFR & Volume\_EFFR & Percentile01\_EFFR & Percentile25\_EFFR & Percentile75\_EFFR & Percentile99\_EFFR \\
selected\_columnsE & 368.60 & 99.56 & 365.45 & 367.56 & 369.18 & 388.81 \\ 
  Tstatsinflation & 362.14 & 455.92 & 340.85 & 360.99 & 364.26 & 373.12 \\ 
  Bstatsinflation & 362.20 & 469.75 & 341.46 & 361.01 & 364.38 & 374.80 \\ 
  Sstatsinflation & 364.07 & 1199.94 & 355.36 & 362.03 & 367.71 & 376.72 \

& Category & Median & IQR & RANGE \\ 
  \hline
  EFFR & EFFR & 368.60 & 1.62 & 23.36 \\ 
  OBFR & OBFR & 367.56 & 2.21 & 17.91 \\ 
  TGCR & TGCR & 362.14 & 3.26 & 32.27 \\ 
  BGCR & BGCR & 362.20 & 3.36 & 33.34 \\ 
  SOFR & SOFR & 364.07 & 5.68 & 21.35 \\ 
-->


```{r, norm stats,echo=FALSE}
median_values = c(Estatsnorm[1], Ostatsnorm[1], Tstatsnorm[1], Bstatsnorm[1], Sstatsnorm[1])
iqr_values = c(Estatsnorm[7] - Estatsnorm[6], Ostatsnorm[5] - Ostatsnorm[4], Tstatsnorm[5] - Tstatsnorm[4], Bstatsnorm[5] - Bstatsnorm[4], Sstatsnorm[5] - Sstatsnorm[4])
range_values = c(Estats[8] - Estats[5], Ostats[6] - Ostats[3], Tstats[6] - Tstats[3], Bstats[6] - Bstats[3], Sstats[6] - Sstats[3])
normstats <- data.frame(Category = categories, Median = median_values, IQR = iqr_values, RANGE=range_values)
normstats2 <- xtable(normstats)
print(normstats2)
```
`
```{r, adjust characteristics data,echo=FALSE}
k=2  
bgn<-begn[k]
edn<-endn[k]
adjust<-rrbp[bgn:edn,]  # rates plot
qadjustE=quantilesE[bgn:edn,]
# stats_adjust<-colMeans(quantilesE[bgn_edn,]     #adjust
qadjustE=quantilesE[bgn:edn,] # EFFR, FOMC, Target  plot
Estatsadj <- colMeans(numeric_quantilesE[bgn:edn,], na.rm = TRUE)
Ostatsadj <- colMeans(numeric_quantilesO[bgn:edn,], na.rm = TRUE)
Tstatsadj <- colMeans(numeric_quantilesT[bgn:edn,], na.rm = TRUE)
Bstatsadj <- colMeans(numeric_quantilesB[bgn:edn,], na.rm = TRUE)
Sstatsadj <- colMeans(numeric_quantilesS[bgn:edn,], na.rm = TRUE)
```

```{r, adjust characteristics,echo=FALSE}
selected_columnsE<- Estatsadj[c("EFFR","Volume_EFFR","Percentile01_EFFR", "Percentile25_EFFR","Percentile75_EFFR","Percentile99_EFFR")]
 adjchar <- rbind(selected_columnsE, Tstatsadj,Bstatsadj,Sstatsadj)
 adjchar2 <- xtable(adjchar)
 print(adjchar2)
```
```

```{r, adjust statss,echo=FALSE}
median_values = c(Estatsadj[1], Ostatsadj[1], Tstatsadj[1], Bstatsadj[1], Sstatsadj[1])
iqr_values = c(Estatsadj[7] - Estatsadj[6], Ostatsadj[5] - Ostatsadj[4], Tstatsadj[5] - Tstatsadj[4], Bstatsadj[5] - Bstatsadj[4], Sstatsadj[5] - Sstatsadj[4])
range_values = c(Estats[8] - Estats[5], Ostats[6] - Ostats[3], Tstats[6] - Tstats[3], Bstats[6] - Bstats[3], Sstats[6] - Sstats[3])
adjstats <- data.frame(Category = categories, Median = median_values, IQR = iqr_values, RANGE=range_values)
adjstats2 <- xtable(adjstats)
print(adjstats2)
```
```{r, covid characteristics data,echo=FALSE}
k=3  
bgn<-begn[k]
edn<-endn[k]
covid<-rrbp[bgn:edn,]
qcovidE=quantilesE[bgn:edn,]
# stats_covid<-colMeans(quantilesE[bgn_edn,]      #covid
qcovidE=quantilesE[bgn:edn,]
Estatscovid <- colMeans(numeric_quantilesE[bgn:edn,], na.rm = TRUE)
Ostatscovid <- colMeans(numeric_quantilesO[bgn:edn,], na.rm = TRUE)
Tstatscovid <- colMeans(numeric_quantilesT[bgn:edn,], na.rm = TRUE)
Bstatscovid <- colMeans(numeric_quantilesB[bgn:edn,], na.rm = TRUE)
Sstatscovid <- colMeans(numeric_quantilesS[bgn:edn,], na.rm = TRUE)
```

```{r, covid characteristics,echo=FALSE}
selected_columnsE<- Estatscovid[c("EFFR","Volume_EFFR","Percentile01_EFFR", "Percentile25_EFFR","Percentile75_EFFR","Percentile99_EFFR")]
 covidchar <- rbind(selected_columnsE, Tstatscovid,Bstatscovid,Sstatscovid)
 covidchar2 <- xtable(covidchar)
 print(covidchar2)
```

```{r, covid stats,echo=FALSE}
median_values = c(Estatscovid[1], Ostatscovid[1], Tstatscovid[1], Bstatscovid[1], Sstatscovid[1])
iqr_values = c(Estatscovid[7] - Estatscovid[6], Ostatscovid[5] - Ostatscovid[4], Tstatscovid[5] - Tstatscovid[4], Bstatscovid[5] - Bstatscovid[4], Sstatscovid[5] - Sstatscovid[4])
range_values = c(Estats[8] - Estats[5], Ostats[6] - Ostats[3], Tstats[6] - Tstats[3], Bstats[6] - Bstats[3], Sstats[6] - Sstats[3])
covidstats <- data.frame(Category = categories, Median = median_values, IQR = iqr_values, RANGE=range_values)
covidstats2 <- xtable(covidstats)
print(covidstats2)
```
```{r, zlb characteristics data,echo=FALSE}
k=4  
bgn<-begn[k]
edn<-endn[k]
zlb<-rrbp[bgn:edn,]
qzlbE=quantilesE[bgn:edn,]
qzlbE=quantilesE[bgn:edn,]
Estatszlb <- colMeans(numeric_quantilesE[bgn:edn,], na.rm = TRUE)
Ostatszlb <- colMeans(numeric_quantilesO[bgn:edn,], na.rm = TRUE)
Tstatszlb <- colMeans(numeric_quantilesT[bgn:edn,], na.rm = TRUE)
Bstatszlb <- colMeans(numeric_quantilesB[bgn:edn,], na.rm = TRUE)
Sstatszlb <- colMeans(numeric_quantilesS[bgn:edn,], na.rm = TRUE)
```

```{r, zlb characteristics,echo=FALSE}
selected_columnsE<- Estatszlb[c("EFFR","Volume_EFFR","Percentile01_EFFR", "Percentile25_EFFR","Percentile75_EFFR","Percentile99_EFFR")]
 zlbchar <- rbind(selected_columnsE, Tstatszlb,Bstatszlb,Sstatszlb)
 zlbchar2 <- xtable(zlbchar)
 print(zlbchar2)
```

```{r, zlb statss,echo=FALSE
median_values = c(Estatszlb[1], Ostatszlb[1], Tstatszlb[1], Bstatszlb[1], Sstatszlb[1])
iqr_values = c(Estatszlb[7] - Estatszlb[6], Ostatszlb[5] - Ostatszlb[4], Tstatszlb[5] - Tstatszlb[4], Bstatszlb[5] - Bstatszlb[4], Sstatszlb[5] - Sstatszlb[4])
range_values = c(Estats[8] - Estats[5], Ostats[6] - Ostats[3], Tstats[6] - Tstats[3], Bstats[6] - Bstats[3], Sstats[6] - Sstats[3])
zlbstats <- data.frame(Category = categories, Median = median_values, IQR = iqr_values, RANGE=range_values)
zlbstats2 <- xtable(zlbstats)
print(zlbstats2}
```

```{r, inflation characteristics data,echo=FALSE}
k=5 
bgn<-begn[k]
edn<-endn[k]
inflation<-rrbp[bgn:edn,]
qinflationE=quantilesE[bgn:edn,]
# stats_inflation<-colMeans(quantilesE[bgn_edn,]  #inflation
Estatsinflation <- colMeans(numeric_quantilesE[bgn:edn,], na.rm = TRUE)
Ostatsinflation <- colMeans(numeric_quantilesO[bgn:edn,], na.rm = TRUE)
Tstatsinflation <- colMeans(numeric_quantilesT[bgn:edn,], na.rm = TRUE)
Bstatsinflation <- colMeans(numeric_quantilesB[bgn:edn,], na.rm = TRUE)
Sstatsinflation <- colMeans(numeric_quantilesS[bgn:edn,], na.rm = TRUE)
```
```{r, inflation characteristics,echo=FALSE}
selected_columnsE<- Estatsinflation[c("EFFR","Volume_EFFR","Percentile01_EFFR", "Percentile25_EFFR","Percentile75_EFFR","Percentile99_EFFR")]
 inflationchar <- rbind(selected_columnsE, Tstatsinflation,Bstatsinflation,Sstatsinflation)
 inflationchar2 <- xtable(inflationchar)
 print(inflationchar2)
```

```{r, inflation stats,echo=FALSE}
median_values = c(Estatsinflation[1], Ostatsinflation[1], Tstatsinflation[1], Bstatsinflation[1], Sstatsinflation[1])
iqr_values = c(Estatsinflation[7] - Estatsinflation[6], Ostatsinflation[5] - Ostatsinflation[4], Tstatsinflation[5] - Tstatsinflation[4], Bstatsinflation[5] - Bstatsinflation[4], Sstatsinflation[5] - Sstatsinflation[4])
range_values = c(Estats[8] - Estats[5], Ostats[6] - Ostats[3], Tstats[6] - Tstats[3], Bstats[6] - Bstats[3], Sstats[6] - Sstats[3])
inflationstats <- data.frame(Category = categories, Median = median_values, IQR = iqr_values, RANGE=range_values)
inflationstats2 <- xtable(inflationstats)
print(inflationstats2)
```



 
<!--
1. normalcy   3/4/2016-7/31/2019      4  859
2. mid cycle adjustment 8/1/2019-10/31/2019 737660  860 - 923
3. covid 11/1/2019-/16/2020   924  1032
4. zlb         3/17/2020-3/16/2022     1032-1516
5. Taming inflation 03/17/2022-12/14/2023 1517-1960  Correct with new end point
-->

```{r, adjustment period, echo=FALSE}
#2.   3/4/2016		7/31/2019      4  859
k=2
bgn<-begn[k]
edn<-endn[k]
adjust<-rrbp[bgn:edn,]
qadjustE=quantilesE[bgn:edn,]
```

(see Figure \@ref(fig:EFFR during adjustment period  8/1/2019 - 10/31/2019-plot)
```{r, fig.cap= "EFFR during adjustment period  8/1/2019 - 10/31/2019"}
#adjust2 = subset(adjust, select = -c(sdate2)) 
meltrates_adjust <- melt(adjust,id="sdate")
rates_adjust <- ggplot(meltrates_adjust,aes(x=sdate,y=value,colour=variable,group=variable)) + 
  geom_line() +
  labs(x="Date", y = "Basis Points (bp)", color = "Rate", linetype = "Rate") +  
  scale_y_continuous(breaks = seq(125, 250, by = 10), limits = c(125, 250)) + 
  theme_minimal()
#theme(axis.title.x=element_blank(), axis.text.x= element_text(size=8,vjust =.5),plot.tag = element_text(size=8,hjust = 0),plot.tag.position = c(0.5,-.01))
print(rates_adjust)
```

```{r, covid, echo=FALSE}
#3. covid   3/4/2016		7/31/2019      4  859
k=3
bgn<-begn[k]
edn<-endn[k]
covid<-rrbp[bgn:edn,]
qcovidE=quantilesE[bgn:edn,]
```

(see Figure \@ref(fig:EFFR during covid period 11/1/2019-3/16/2020-plot)
```{r, fig.cap= "EFFR during covid period  11/1/2019-3/16/2020"}
#covid2 = subset(covid, select = -c(sdate2)) 
meltrates_covid <- melt(covid,id="sdate")
rates_covid <- ggplot(meltrates_covid,aes(x=sdate,y=value,colour=variable,group=variable)) + 
  geom_line() +
  labs(x="Date", y = "Basis Points (bp)", color = "Rate", linetype = "Rate") +  
  scale_y_continuous(breaks = seq(0, 200, by = 25), limits = c(0, 200)) + 
  theme_minimal()
#theme(axis.title.x=element_blank(), axis.text.x= element_text(size=8,vjust =.5),plot.tag = element_text(size=8,hjust = 0),plot.tag.position = c(0.5,-.01))
print(rates_covid)
```


```{r, zero lower bound, echo=FALSE}
#4.zlb    3/4/2016		7/31/2019      4  859
k=4
bgn<-begn[k]
edn<-endn[k]
zlb<-rrbp[bgn:edn,]
qzlbE=quantilesE[bgn:edn,]
```

(see Figure \@ref(fig:EFFR during zero lower bound (Zlb) period 3/17/2020-3/16/2022
```{r, fig.cap= "EFFR during zero lower bound (zlb) period 3/17/2020-3/16/2022"}
#zlb2 = subset(zlb, select = -c(sdate2)) 
meltrates_zlb <- melt(zlb,id="sdate")
rates_zlb <- ggplot(meltrates_zlb,aes(x=sdate,y=value,colour=variable,group=variable)) + 
  geom_line() +
  labs(x="Date", y = "Basis Points (bp)", color = "Rate", linetype = "Rate") +  
  scale_y_continuous(breaks = seq(0, 15, by = 5), limits = c(0, 15)) + 
  theme_minimal()
#theme(axis.title.x=element_blank(), axis.text.x= element_text(size=8,vjust =.5),plot.tag = element_text(size=8,hjust = 0),plot.tag.position = c(0.5,-.01))
print(rates_zlb)
```

```{r, inflation, echo=FALSE}
#5. inflation   3/4/2016		7/31/2019      4  859
k=5
bgn<-begn[k]
edn<-endn[k]
inflation<-rrbp[bgn:edn,]
qinflationE=quantilesE[bgn:edn,]
```

(see Figure \@ref(fig:EFFR during inflation period 3/17/2022-12/14/2023-plot)
```{r, fig.cap= "EFFR during inflation period 03/17/2022-12/14/2023"}
#inflation2 = subset(inflation, select = -c(sdate2)) 
meltrates_inflation <- melt(inflation,id="sdate")
rates_inflation <- ggplot(meltrates_inflation,aes(x=sdate,y=value,colour=variable,group=variable)) + 
  geom_line() +
  labs(x="Date", y = "Basis Points (bp)", color = "Rate", linetype = "Rate") +  
  scale_y_continuous(breaks = seq(0, 500, by = 50), limits = c(0, 500)) + 
  theme_minimal()
#theme(axis.title.x=element_blank(), axis.text.x= element_text(size=8,vjust =.5),plot.tag = element_text(size=8,hjust = 0),plot.tag.position = c(0.5,-.01))
print(rates_inflation)
```

```{r ,  EFFR and percentiles, echo=FALSE, fig.cap="Overnight rates EFFR percentiles Normalcy"}  
qnormE2 = subset(qnormE, select = -c(Volume_EFFR, Percentile01_EFFR, Percentile99_EFFR) ) 
quantEnorm <- melt(qnormE2,id="sdate")
quantE_norm <- ggplot(quantEnorm ,aes(x=sdate,y=value,colour=variable,group=variable)) + 
  geom_line() +
  labs(x="Date",  y = "Basis Points (bp)", color = "Rate", linetype = "Rate") +  
  scale_y_continuous(breaks = seq(0, 350, by = 25), limits = c(0, 350)) + 
  theme_minimal()
#theme(axis.title.x=element_blank(), axis.text.x= element_text(size=8,vjust =.5),plot.tag = element_text(size=8,hjust = 0),plot.tag.position = c(0.5,-.01))
print(quantE_norm)
```

```{r , echo=FALSE, fig.cap="Overnight rates EFFR percentiles adjustment period"}
qadjustE2 = subset(qadjustE, select = -c(Volume_EFFR, Percentile01_EFFR, Percentile99_EFFR) ) 
quantEadjust <- melt(qadjustE2,id="sdate")
quantE_adjust <- ggplot(quantEadjust ,aes(x=sdate,y=value,colour=variable,group=variable)) + 
  geom_line() +
  labs(x="Date",  y = "Basis Points (bp)", color = "Rate", linetype = "Rate") +  
  scale_y_continuous(breaks = seq(125, 250, by = 25), limits = c(125, 250)) + 
  theme_minimal()
#theme(axis.title.x=element_blank(), axis.text.x= element_text(size=8,vjust =.5),plot.tag = element_text(size=8,hjust = 0),plot.tag.position = c(0.5,-.01))
print(quantE_adjust)
```

```{r, EFFR percentiles covid, echo=FALSE, fig.cap="Overnight rates EFFR percentiles during covid"}
qcovidE2 = subset(qcovidE, select = -c(Volume_EFFR, Percentile01_EFFR, Percentile99_EFFR) ) 
quantEcovid <- melt(qcovidE2,id="sdate")
quantE_covid <- ggplot(quantEcovid ,aes(x=sdate,y=value,colour=variable,group=variable)) + 
  geom_line() +
  labs(x="Date",  y = "Basis Points (bp)", color = "Rate", linetype = "Rate") +  
  scale_y_continuous(breaks = seq(0, 200, by = 25), limits = c(0, 200)) + 
  theme_minimal()
#theme(axis.title.x=element_blank(), axis.text.x= element_text(size=8,vjust =.5),plot.tag = element_text(size=8,hjust = 0),plot.tag.position = c(0.5,-.01))
print(quantE_covid)
```

```{r, EFFR percentiles zlb, echo=FALSE, fig.cap="Overnight rates EFFR percentiles zero lower bound"}
qzlbE2 = subset(qzlbE, select = -c(Volume_EFFR, Percentile01_EFFR, Percentile99_EFFR) ) 
quantEzlb <- melt(qzlbE2,id="sdate")
quantE_zlb <- ggplot(quantEzlb ,aes(x=sdate,y=value,colour=variable,group=variable)) + 
  geom_line() +
  labs(x="Date",  y = "Basis Points (bp)", color = "Rate", linetype = "Rate") +  
  scale_y_continuous(breaks = seq(0, 15, by = 5), limits = c(0, 15)) + 
  theme_minimal()
#theme(axis.title.x=element_blank(), axis.text.x= element_text(size=8,vjust =.5),plot.tag = element_text(size=8,hjust = 0),plot.tag.position = c(0.5,-.01))
print(quantE_zlb)
```

```{r, EFFR percentiles inflation, echo=FALSE, fig.cap="Overnight rates EFFR percentiles inflation"}
qinflationE2 = subset(qinflationE, select = -c(Volume_EFFR, Percentile01_EFFR, Percentile99_EFFR) ) 
quantEinflation <- melt(qinflationE2,id="sdate")
quantE_inflation <- ggplot(quantEinflation ,aes(x=sdate,y=value,colour=variable,group=variable)) + 
  geom_line() +
  labs(x="Date",  y = "Basis Points (bp)", color = "Rate", linetype = "Rate") +  
  scale_y_continuous(breaks = seq(0, 350, by = 25), limits = c(0, 350)) + 
  theme_minimal()
#theme(axis.title.x=element_blank(), axis.text.x= element_text(size=8,vjust =.5),plot.tag = element_text(size=8,hjust = 0),plot.tag.position = c(0.5,-.01))
print(quantE_inflation)
```

# Daily volumes

# Volatility
TORBEN G. ANDERSEN, LUCA BENZONI, and JESPER LUND
Benzoni  Moreover, we conduct simultaneous and efficient inference regarding all model
components which include a shock to the interest rate process itself, a time-varying mean reversion factor, a stochastic volatility factor and a jump process. Most intriguingly, we find that
the restrictions implied by an affine representation of the jump-diffusion system are not rejected
by the U.S. short rate data. This allows for a tractable setting for associated asset pricing
application

Aıt-Sahalia (1996b strong nonlinearity of the drift coefficient. He finds that around its mean, where the drift is essentially zero, the spot rate
behaves like a random walk. The drift then mean-reverts strongly when far away from the mean

CHLS stress that this dynamic behavior does
not necessarily imply non-linearity, or even mean-reversion, of the drift coefficient, but instead may
result from so-called volatility-induced stationarity governed mainly through the specification of the
diffusion coefficient.
More recently, Bandi (2002) also argues that the constant-elasticity-of-variance model with linear
drift fails due to the martingale nature of the short rate over most of its empirical range, with the
indications of nonlinearities in the drift term driven exclusively by a small number of observations at
the edges of the sample domain

 more general drift and diffusion specifications are necessary
 
Main features of the U.S. short-term interest rate, i.e., 
 - complex conditional heteroskedasticity, 
 - fat-tailed innovations and 
 - pronounced autocorrelation patterns, 
may be captured within an intuitively appealing and manageable continuous-time jump-diffusion setting.
Relative to earlier contributions, we explore a more general parametric class of continuous-time models, allowing for both multiple latent factors, entering separately in the drift and diffusion coefficients,
and jumps in the interest rate level. Furthermore, we investigate alternative representations both
within and outside of the affine class.
 * multiple latent factors, entering separately in the drift and diffusion coefficients,
and jumps in the interest rate level.

Both of our favored models contain three factors featuring stochastic volatility, mean drift and
jumps. The inclusion of the stochastic volatility factor is critical for a good fit, whereas the stochastic mean offers a more modest, but still significant, improvement. Specifically, we find it important to allow for a relatively fast mean-reversion of the short rate around a highly persistent time-varying central tendency process. Economically, the mean drift may be indicative of slowly evolving inflationary expectations, time-variation in the required real interest rate, or both. Furthermore, we find jump to be integral to the quality of fit and to relieve the stochastic volatility factor from accommodating extreme outlier behavior. Without jumps, the estimated volatility specifications are unable to match the degree of persistence in the conditional variance process typically observed in short-term interest rate series. Interestingly, we find little evidence of the so-called level effect. Moreover, our analysis suggests that correlation between the shocks to the short rate process and the other two latent factors is not critical in modeling the short rate series.

Section 4 e semi-nonparametric (SNP) model selection procedure used to obtain the moment conditions for the subsequent EMM estimation step. The family of SNP densities introduced
by Gallant and Nychka (1987) provides a natural starting point for this task. Loosely speaking,
Gallant and Long (1997) show that the score function of an SNP density asymptotically spans the
score of the true model, suggesting that the EMM methodology is asymptotically efficient when
the order of the SNP model is expanded until an adequate statistical representation of the data is
obtained

score https://scikit-learn.org/stable/modules/model_evaluation.html

we adopt an EGARCH form. This choice is motivated not only by goodness-of-fit
criteria, but also by the analysis in Andersen and Lund (1997), which shows that an EGARCH score
generator has better “dynamic stability” properties than, e.g., a GARCH model, a consideration
which proves important in the EMM implementation

Equation 11

We estimate the SNP densities in (11) by (quasi-)maximum likelihood (QML).

Our analysis, summarized in Table 2, points towards an ARMA(4,1)-Level-EGARCH(2,1)-Kz(6)-
Kx(0). More specifically, a relatively high order ARMA term is necessary to reproduce the rich
conditional mean dynamics and to eliminate most of the dependencies in the residuals. Similarly,
a combined analysis of the information criteria and Ljung-Box statistics indicates the need for a
second-order EGARCH term, enriched with the presence of level effects.

4.2.6 Affine Stochastic Volatility and Jumps
jumps of the magnitude associated with Federal Reserve Bank changes in the federal funds rate of
a quarter or half percentage point. 

4.2.7 Affine Stochastic Volatility, Mean Drift, and Jump
![Alt text](C:/Users/Owner/Documents/Research/MonetaryPolicy/LaTeX/Benzonieqns8910.png)
![Benzonieqns](C:/Users/Owner/Documents/Research/MonetaryPolicy/LaTeX/Benzonieqns8910.png)



```{r, log pct change rates nday 5, echo=FALSE}
measure1 <- log(rrbp[(bgn+1):edn,2:6])-log(rrbp[bgn:(edn-1),2:6]);
for (i in seq_along(measure1)) {
  measure1[[i]][is.infinite(measure1[[i]])] <- 0
}
# measure1[is.infinite(measure1)] <- 0 not for lists
# y <- ifelse(is.infinite(x), 0, x)  if you want a new variable

mxq = max(measure1[,1:5])
mnq = min(measure1[,1:5])

my_color_palette <- c("EFFR" = "darkblue", "OBFR" = "darkgreen", "TGCR" = "darkred", "BGCR" = "darkcyan", "SOFR" = "darkorange")

measure1$sdate =sdate[(bgn+1):edn]
meltmeasure1r <- melt(measure1,id="sdate")
#meltmeasure1r <- melt(measure1_no_na,id="sdate")
measure1r <- ggplot(meltmeasure1r,aes(x=sdate,y=value,colour=variable,group=variable)) + 
  geom_point(size = 1, shape = 16) +
  labs(x="Date",  y = "Pct Change Basis Points (bp)", color = "Pct change", shape = "Pct change") +  
  scale_y_continuous(breaks = seq(0, mxq, by = .05), limits = c(0, mxq)) + 
  theme_minimal() + guides(shape = guide_legend(title = "Pct change"))
# + theme(axis.title.x=element_blank(), axis.text.x= element_text(size=8,vjust =.5))
print(measure1r)
```
```{r,rolling std rates nday 5, echo=FALSE}
# multivariate rolling stdev-------------------
nday <- 5
sdates <- measure1$sdate  # Assuming sdate is the column containing dates

# Select the first five columns of measure1 for calculation, excluding sdate
measure_subset <- measure1[, 1:5]
# Apply rolling standard deviation directly on the data frame
sdrates <- rollapply(measure_subset, width = nday, FUN = sd, align = "right", fill = NA)
sdates[is.na(sdrates)]<-0

# Convert the result to a data frame
sdrates <- as.data.frame(sdrates)

mxq = max(sdrates[,1:5]) # 1.089607
mnq = min(sdrates[,1:5]) # 0


meltsdrates <- melt(sdrates,id="sdate")
plotsdrates <- ggplot(meltsdrates,aes(x=sdate,y=value,colour=variable,group=variable)) + 
  geom_point(size = 1, shape = 16) +
  labs(x="Date",  y = "Pct Change Basis Points (bp)", color = "Std dev pct change", shape = "Std dev pct change") +  
  scale_y_continuous(breaks = seq(0, mxq, by = .05), limits = c(0, mxq)) + 
  theme_minimal() + guides(shape = guide_legend(title = "Pct change"))
# + theme(axis.title.x=element_blank(), axis.text.x= element_text(size=8,vjust =.5))
print(plotsdrates)
```
```{r, Duffie Krishnamurthy index,, echo=FALSE}
meltdkindex <- melt(dkindex,id="sdate")
dk <- ggplot(meltdkindex,aes(x=sdate,y=value,colour=variable,group=variable)) + 
  geom_point(size = 1, shape = 16) +
  labs(x="Date",  y = "Duffie Krishnamurthy index", color = "Dispersion", shape = "Dispersion") +  
  scale_y_continuous(breaks = seq(0, mxq, by = 10), limits = c(0, mxq)) + 
  theme_minimal() + guides(shape = guide_legend(title = "Pct change"))
# + theme(axis.title.x=element_blank(), axis.text.x= element_text(size=8,vjust =.5))
print(dk)
```

## dispersion measures hypothesis 2
## Dispersion
The Duffie Krishnamurthy indes of dispersion of overnight rate,  the weighted mean absolute deviation of the cross-sectional adjusted rates (Figure ~\ref{figure:dispersionDK})   (Table %~\ref{table:dispersionDK}) ) 
Duffie Krishamurthy ()) measure the dispersion of overnight rates as the absolute deviation of the cross rates of overnight reference and money market rates. This indicator indiates the level of passthrough inefficiency, the passthrough effectiveness of the Federal Reserve’s monetary policy, the transmission of policy to the economy through other short term rates.
\cite{DuffieKrishnamurthi} 

<!--2. Figure Description:
Provide a clear and concise description of the figure. Include relevant details about the data, axes, labels, units, and any key components.
-->

Their index of rate dispersion $DK_t$ for day t in U.S. short-term money markets is the weighted mean absolute deviation of the cross-sectional distribution of overnight-equivalent rates on that day. $DK_t$ is constructed from overnight equivalent rates $\hat{r}_{i,t}$. Rates are adjusted for term and credit spreads. 
#after adjusting for premia associated with credit risk and term structure.frictions associated with imperfect #competition, regulation, infrastructure, and other forms of institutional segmentation within money markets.

<!--
  correct eqn
\begin{equation*}
DK_t=\frac{1}%{\sum_{i}^{v_{i,t}}+\sum_{i}%^{v_{i,t}} +\hat{r}_{i,t}-%\bar{y}_t
\end{equation*}
-->
 
 <!--
3. Interpretation:
Discuss the main findings or trends depicted in the figure. Highlight significant patterns, relationships, or differences. Use specific data points to support your interpretations.
-->

Their results show dispersion ranged between 4 and 7 basis points between the end of 2012 and December 17, 2015. Dispersion increased by over 10 basis points, immediately after the first passthrough event in the current Fed monetary policy setting, when the interest rate paid by the Fed on excess reserves (IOER) was increased from 25 to 50 basis basis points on December 17, 2015.

In our sample from 2016 through 2022, the Duffie Krishnamurthy diversity index registers low dispersion, under 4 basis points, among the five overnight rates  EFFR, OBFR, TGCR, BGCR, and SOHR during 2016 and the first quarter of 2017 before jumping to around 5 during the last 2 weeks of March 2017 
%(Figure \ref{fig:dispersionDK}.


Their measure of dispersion rises to over 50 basis points during December 2018 to mid April 2019. The index triples to 151.14 basis on April 19, 2019 and remains at this high level, reaching a high 254.83 points during the spike in repo rates September 19, 2019. The index tapers off after of the dash for cash on March 17, 2020 after spiking 27.5 basis points. Throughout 2020 and 2021, the index was under 1 point. The level of dispersion rose steadily during March 2022, reaching over 200 basis points during the last part of December 2022 as the FOMC raised the target range for the  Federal Funds rate to fight inflation. The index rose  from 14.57 April 15, 2022 to 209.25 on December 29, 2022.

<!--
4. Connection to Hypotheses or Research Questions:
Relate the figure's content to the research questions or hypotheses you're addressing in your study. Explain how the figure's information contributes to answering these questions or testing these hypotheses.
-->
Duffie and Krishnamurthy argue that the current setting of U.S.-dollar money markets limits the transmission of Fed policy to the economy. For the objective of this paper, to understand Fed tolerance for volatility of the FFR, we would need to examine any relation between volatility, the distance of the FFR within its target range, and this measure of dispersion of rates. 

The Gara index does just this, the distance of the FFR within its target rang

<!--
Duplication?
Dispersion measures
Dispersion of rates imply rates follow different distributions
#Gara Afonso, Kyungmin Kim, Antoine Martin, Ed Nosal, Simon Potter, and Sam Schulhofer-Wohl propose  dispersion #index  $D_t$ of the daily EFFR from upper and lower target rates.
Duffie and Alonso provide evidence that there exists significant dispersion of the money market rates from the policy rate that suggest problems for transmission of FONC to the broader economy.
The effectiveness of monetary policy to transmit the desired stance of monetary policy to financial markets and the real economy economy depends on efficient transmission of rate changes to other short rates in wholesale and consumer funding market. 

Duffie, Krishnamurthi identify dispersion across money market interest rates as a primary indicator
of the level of efficiency in how other key short-term interest rates reflect Fed policy changes. This paper
examines the dispersion and volatility of short term rates.
Duffie and Alonso study of dispersion of overnight wholesale money market rates from the policy rate that suggests problems for transmission of FONC policy to the broader economy.

1. The dispersion index of the five daily rates from 2016 to 2922
#(Figure \ref{figures:})
follows the pattern set by the FOMC lower and upper target rates. If the Fed implicitly responds to volatility in the FFR through information on wholesale money market rates, our model of volatility of the EFFR should include thise index

2. The weighted mean absolute deviation of the cross-sectional adjusted rate
distribution on that day. That is,
Dt =
1
P
i
vi,t
X
i
vi,t |ybi,t − y¯t
|, (4.2)
where vi,t is the estimated outstanding amount of this instrument on day t, in dollars,
and y¯t
is the volume-weighted mean rate, defined by
y¯t =
P
i
P
vi,t ybi,t
i
vi,t
.
This index has a negative bias, relative to dispersion across all actual money-market
transactions rates, because it does not incorporate the heterogeneity of individual transaction rates within each segment of money markets.
Figure 4.2 shows the variation of the dispersion index Dt over the sample period. As
shown, dispersion increases in the run-up to the covid pandemican, punctuated by the major disturbance in repo marketsm and the March 2020 dash for cash events, peaking in March 2020. Dispersion
decreased [when]  but leveled off to a higher value during the zero lower bound period but lower that the covid period. The index rises with the successive  Fed rate increases to tame inflation

3. If the Fed implicitly responds to volatility in the FFR through information on wholesale money market rates, our model of volatility of the EFFR should include thise index

4. limitations

<!--
Table 1
provides the results of a time-series regression of dispersion on various explanatory
variables: the Markit CDX index (as a measure of crisis severity); the target federal
funds rate (which, in the post-2008 period, is set at the middle of the Fed’s target
range for FFER); an end-of-quarter dummy; and a post-2014 dummy. The first of
these dummies captures the effect of the quarter-end window-dressing of bank balance
sheets, described in Section 6. The second dummy picks up the change in dispersion
since 2014, after which several significant new bank regu
-->


``{r, Duffie Krishnamurthy dispersion,  echo=FALSE}
rcol <- 5

# Initialize vectors to store results
dkindex <- numeric(1710)
meanr> colMeans(rrbp)
# EFFR  OBFR  TGCR  BGCR  SOFR 
# FALSE FALSE FALSE FALSE FALSE 
colsumvold <-rowSums(vold[ , c(1,2,3,4,5)], na.rm=TRUE)
colsumvold[1:10]
#[1] 1739 1730 1714 1691 1671 1693 1705 1656 1658 1641

  T<-nrow(rrbp)
  # Calculate dk(t)
  for (t in 1:T) {
  for (i in 1:rcol) {
    dk[t, i] <- (1 / colsumvold[t]) * vold[t,i]*abs(rrbp[t, i] - meanr[i])
  }
}
  
  # Calculate dkindex(t)
  for (t in 1:T) {
  dkindex[t] <- sum(dk[t, 1:rcol])
  }

# Convert the "sdate" column to a Date format
dk_data$sdate <- sdate
dk_data <- cbind(sdate, dk, dkindex,TargetDe, TargetUe)
# Convert the numeric matrix 'dk_data' to a data frame
dk_data <- data.frame(dk_data)
# Assign names to the columns of 'dk' within 'dk_data'
colnames(dk_data)[2:6] <- c("EFFR", "OBFR", "TGCR", "BGCR", "SOFR")
# Set column names for 'dk_data'
colnames(dk_data) <- c("sdate", "EFFR", "OBFR", "TGCR", "BGCR", "SOFR", "dkindex", "TargetDe", "TargetUe")

file_path<-"C:/Users/Zenobia/Documents/Research/MonetaryPolicy/MonetaryPolicy/Data/indices2.csv"
write.csv(dk_data, file = file_path, row.names = FALSE)
```


#as.Date(dk_data$sdate, format = "%y/%m/%d)
ggdkindex<-ggplot(dk_data, aes(x = sdate)) +
  geom_point(aes(y = dk_data[,7], color = "Duffie Krishnamurthy index"), shape = 16, size = 1) + 
  geom_point(aes(y = TargetDe, color = "Lower target FFR"), shape = 16, size = 1) + 
  geom_point(aes(y = TargetUe, color = "Upper target FFR"), shape = 16, size = 1) +
 # geom_point(aes(y = rrbp[,3], color = "TGCR"), shape = 16, size = 1) + 
 # geom_point(aes(y = rrbp[,4], color = "BGCR"), shape = 16, size = 1) + 
 # geom_point(aes(y = rrbp[,5], color = "SOFR"), shape = 16, size = 1) + 
  labs(x = "X-axis", y = "Y-axis", color = "Lines") +
  scale_color_manual(values = c("Duffie Krishnamurthy index" = "black", "Lower target FFR" = "blue", "Upper target FFR"= "green" )) + 
  #scale_color_manual(values = c("EFFR" = "black", "OBFR" = "blue", "TGCR" = "green", "BGCR" = "orange", "SOFR" = "red")) + 
  theme_minimal()
print(ggdkindex)


Gara. The daily value of $D_t$ ,the deviations between the value weighted daily fed funds rate and weighted fed funds rate, the actual policy target (the EFFR, the effective fed funds rate published by the Federal Reserve Bank of New York) FOMC  (Figure), During  2016-2022 managing the policy rate within its target range may have become more challenging during stress in repo markets in 2019 (\ref{fig:dispersionEffrGara}). ADD OBSERVATIONS


Gara Afonso, Kyungmin Kim, Antoine Martin, Ed Nosal, Simon Potter, and Sam Schulhofer-Wohl propose  dispersion index  $D_t$ of the daily EFFR from upper and lower target rates.
The daily value of $D_t$ ,the deviations between the value weighted daily fed funds rate and weighted fed funds rate, the actual policy target (the EFFR, the effective fed funds rate published by the Federal Reserve Bank of New York) FOMC  (Figure), During  2016-2022 managing the policy rate remained within its target range (\ref{fig:dispersionEffrGara}). ADD OBSERVATIONS

```{e, Gara index, echo-FALSE}
# Calculate D_t based on conditions
      if (rho_max_t < rho_bar_t) {
        D_t <- rho_bar_t - rho_max_t
      } else if (rho_bar_t < rho_min_t) {
        D_t <- rho_bar_t - rho_min_t
      }
```




Target rates and quintiles EFFR, SOFR
 The behavior of the EFFR and SOFR offer another view of dispersion. 

1.The EFFR stay within the bounds of the FOMC target rates (left panel of Figure ~\ref{igure:}) and the 35th and 75th percentile (right panel)

2.

3.

4. Limitations


1.The SOFR stay within the bounds of the FOMC target rates (left panel of Figure ~\ref{igure:}) and the 35th and 75th percentile (right panel)

2.

3.

4. Limitations

-->

<!-- Duffie Krishnamurthy dispersion index 
 We let yi,t(m) denote the rate at time t on instrument i, maturing in m days. We first
 adjust the rate to remove term-structure effects, 
 obtaining the associated "overnight-equivalent” rate as
 yhat_(i,t) = yi,t(m) − (OISt(m) − OISt(1)), (4.1)
 The dispersion index D at day t as the weighted mean absolute deviation of the cross-sectional adjusted rate
 distribution on that day. That is,
 -->
 
 \begin{align*}
 D_t =1/ (sum_{i}^{}v_{i,t}) times 
 (sum_{i}^{}v_{i,t} |yhat_{i,t} − y¯t|) (4.2)
 where vi,t is the estimated outstanding amount of this instrument on day t, in dollars,
 and y_¯t is the volume-weighted mean rate, defined by
 y¯_t = [(sum_{i}^{}(v_{i,t}) times yhat_{i,t})]/(sum_{i}^{}v_{i,t})
 \end{align*}


Assuming you have already defined vtot, vold, drates, mrate, meanr, and d vectors

```{r, Duffie Krishnamurthy dispersion index, echo=FALSE}
T <-nrow(rrbp)
# Initialize vtot(t) and mrate(t) to zero
vtot<- zeros(T,1);
dk<- zeros(T);
mrate<-zeros(T,1);
meanr<-zeros(T,1);
dkindex<-ggplot(metricE, aes(x = sdate)) +
  geom_point(aes(y = dk[,1], color = "Duffie Krishnamurthy index"), shape = 16, size = 1) + 
  geom_point(aes(y = targetDe, color = "Lower target FFR"), shape = 16, size = 1) + 
  geom_point(aes(y = targetUe, color = "Upper target FFR"), shape = 16, size = 1) +
 # geom_point(aes(y = rrbp[,3], color = "TGCR"), shape = 16, size = 1) + 
 # geom_point(aes(y = rrbp[,4], color = "BGCR"), shape = 16, size = 1) + 
 # geom_point(aes(y = rrbp[,5], color = "SOFR"), shape = 16, size = 1) + 
  labs(x = "X-axis", y = "Y-axis", color = "Lines") +
  scale_color_manual(values = c("Duffie Krishnamurthy index" = "black", "Lower target FFR" = "blue", "Upper target FFR" )) + 
  #scale_color_manual(values = c("EFFR" = "black", "OBFR" = "blue", "TGCR" = "green", "BGCR" = "orange", "SOFR" = "red")) + 
  theme_minimal()
```

<!--
Duffie Kroshnamurthy code
# Loop from t = begn(k) to t = endn(k)
#for (t in begn(k):endn(k)) {
for (t in 1:T) {
  # Loop from i = 1 to i = 5
  for (i in 1:5) {
    # Calculate vtot(t) and mrate(t)
    vtot[t] <- vtot[t] + vold[t, i]
    mrate[t] <- mrate[t] + vold[t, i] * rrbp[t, i]
  }
  
  # Calculate meanr(t)
  meanr[t] <- mrate[t] / vtot[t]
  
  # Calculate dk(t)
  for (i in 1:5) {
    dk[t] <- dk[t] + (1 / vtot[t]) * vold[t, i] * abs(rrbp[t, i] - meanr[t])
  }
}
-->

<!-- 1. Start by introducing the figure and its purpose. Briefly explain what the figure represents and why it's important in the context of your study.
-->
<!--2. Figure Description:
Provide a clear and concise description of the figure. Include relevant details about the data, axes, labels, units, and any key components.
-->
 <!--
3. Interpretation:
Discuss the main findings or trends depicted in the figure. Highlight significant patterns, relationships, or differences. Use specific data points to support your interpretations.
-->
<!--
4. Connection to Hypotheses or Research Questions:
Relate the figure's content to the research questions or hypotheses you're addressing in your study. Explain how the figure's information contributes to answering these questions or testing these hypotheses.
-->


GARA:

<!-- 1. Start by introducing the figure and its purpose. Briefly explain what the figure represents and why it's important in the context of your study.
-->
(Figure ~\ref{figure:dispersionGara})   (Table %~\ref{table:dispersionGara}) ) 

The daily value of $D_t$ is the deviations between the value weighted daily 
fed funds rate (FFR) and the FOMC target, for 2017-2022.
If FFR > upper target TU, $D_t = rho_bar_t - rho_max_t$
FFR < lower target TD $D_t <- rho_bar_t - rho_min_t$
Otherwise $D_t =0$.


Bertolini:
$\nu_t$ is a mean zero, unit variance, i.i.d. error term
The enoirical Fed Funds rate
$r_t = \mu_t + \sigma_t \nu_t$

$ \mu_t=r_{t-1}+\delta_s_t=\Kappa' k_t + \iota(\ast(r_t)-\as(r{_t-1})$

$ \mu_t=r_{t-1}+\Phi(r_{t-1}=r_{t-2})+ \Phi(r_{t-2}=r_{t-3}) +delta_s_t=\Kappa' k_t + \iota(\ast(r_t)-\as(r{_t-1})$

Variance of the FFR $\sigma^2_t=E[(r_t-\mu_t)^2]$

Introduce exponential Garch effects, EGARCH (Nelson 1991)

Allow for deviations of persistent log of conditional variance from its unconditional expected value $-\omega h_t -\psi \nu_t -(1+\gamma N_t)$. Add day if maintenance period effects

The resulting variance for the FFR is
$$log(\sigma^2_t -\omega h_t -\psi \nu_t -(1+\gamma N_t)=\sigma^2_{t=1}  -\omega h_{t-1} -\psi \nu_{t-1}  -(1+\gamma N_{t-1} )+\alpha \abs(\nu_{t-1} ) + \Theta \nu_{t-1} 

Assume t distributions for innovations $\nu$
Obtain maximum likelihood of the parameters, including the degrees of freedom of the t distribution,  by numerical optimization

egarch_spec <- ugarchspec(variance.model = list(model = "eGARCH"), mean.model = list(armaOrder = c(0, 0)))
> egarch_fit <- ugarchfit(spec = egarch_spec, data = rrbpts)
Warning message:
In .egarchfit(spec = spec, data = data, out.sample = out.sample,  : 
ugarchfit-->warning: solver failer to converge.
> egarch_fit <- ugarchfit(spec = egarch_spec, data = rrbpts)
Warning message:
In .egarchfit(spec = spec, data = data, out.sample = out.sample,  : 
ugarchfit-->warning: solver failer to converge.
> residuals <- residuals(egarch_fit)
Error in xts(object@fit$residuals, D) : 
  'order.by' cannot contain 'NA', 'NaN', or 'Inf'
> egarch_spec

*---------------------------------*
*       GARCH Model Spec          *
*---------------------------------*

Conditional Variance Dynamics 	
------------------------------------
GARCH Model		: eGARCH(1,1)
Variance Targeting	: FALSE 

Conditional Mean Dynamics
------------------------------------
Mean Model		: ARFIMA(0,0,0)
Include Mean		: TRUE 
GARCH-in-Mean		: FALSE 

Conditional Distribution
------------------------------------
Distribution	:  norm 
Includes Skew	:  FALSE 
Includes Shape	:  FALSE 
Includes Lambda	:  FALSE 
-->